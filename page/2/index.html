<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    

    <!--Author-->
    
        <meta name="author" content="John Doe">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="Welcome to CCH21&#39;s Blog"/>
    

    <!--Open Graph Description-->
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="Welcome to CCH21&#39;s Blog"/>

    <!--Type page-->
    
        <meta property="og:type" content="website" />
    

    <!--Page Cover-->
    

    <meta name="twitter:card" content="summary" />
    

    <!-- Title -->
    
    <title>page - Welcome to CCH21&#39;s Blog</title>

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/css/bootstrap.min.css" integrity="sha384-y3tfxAZXuh4HwSYylfB+J125MxIs6mR5FOHamPBG064zB+AFeWH94NdvaCBm8qnd" crossorigin="anonymous">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Google Analytics -->
    


</head>


<body>

<div class="bg-gradient"></div>
<div class="bg-pattern"></div>

<!-- Menu -->
<!--Menu Links and Overlay-->
<div class="menu-bg">
    <div class="menu-container">
        <ul>
            
            <li class="menu-item">
                <a href="/">
                    Home
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/archives">
                    Archives
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/about.html">
                    About
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/tags">
                    Tags
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/categories">
                    Categories
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/contact.html">
                    Contact
                </a>
            </li>
            
        </ul>
    </div>
</div>

<!--Hamburger Icon-->
<nav>
    <a href="#menu"></a>
</nav>

<div class="container">

    <!-- Main Content -->
    <div class="row">
    <div class="col-sm-12">

        <!--Title and Logo-->
        <header>
    <div class="logo">
        <a href="/"><i class="logo-icon fa fa-cube" aria-hidden="true"></i></a>
        
            <h1 id="main-title" class="title">Welcome to CCH21's Blog</h1>
        
    </div>
</header>

        <section class="main">
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2020/02/15/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%AF%92%E5%81%87%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E4%BB%BB%E5%8A%A1%E6%80%BB%E7%BB%93/">
                实验室寒假数据处理任务总结
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2020-02-15</span>
            
            
            
        </div>
    </div>

    
        <div class="content">
            <p>想获取输入数据和源代码？<a href="https://github.com/CCH21/Data_processing" target="_blank" rel="noopener">点这里</a>！  </p>
<hr>
<p><strong>处理一</strong>：将数据中所有信息有问题的那行信息删除。如样例中第4行数据，这一行数据只有3个元素，而其他行都有6个元素，所以删除第4行即可。再如最后一行第3个信息明显有问题，所以该行也是问题行，删除即可。将全部数据处理完之后，每行单个元素以逗号为分隔，写入文件test1。<br><strong>输入数据样例</strong>  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">18 Jogging 102271561469000 -13.53 16.89 -6.4</span><br><span class="line">18 Jogging 102271641608000 -5.75 16.89 -0.46</span><br><span class="line">18 Jogging 102271681617000 -2.18 16.32 11.07</span><br><span class="line">18 Jogging 3.36</span><br><span class="line">18 Downstairs 103260201636000 -4.44 7.06 1.95</span><br><span class="line">18 Downstairs 103260241614000 -3.87 7.55 3.3</span><br><span class="line">18 Downstairs 103260321693000 -4.06 8.08 4.79</span><br><span class="line">18 Downstairs 103260365577000 -6.32 8.66 4.94</span><br><span class="line">18 Downstairs 103260403083000 -5.37 11.22 3.06</span><br><span class="line">18 Downstairs 103260443305000 -5.79 9.92 2.53</span><br><span class="line">6 Walking 0 0 0 3.214402</span><br></pre></td></tr></table></figure>

<p><strong>输出test1样例</strong>  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">18,Jogging,102271561469000,-13.53,16.89,-6.4</span><br><span class="line">18,Jogging,102271641608000,-5.75,16.89,-0.46</span><br><span class="line">18,Jogging,102271681617000,-2.18,16.32,11.07</span><br><span class="line">18,Downstairs,103260201636000,-4.44,7.06,1.95</span><br><span class="line">18,Downstairs,103260241614000,-3.87,7.55,3.3</span><br><span class="line">18,Downstairs,103260321693000,-4.06,8.08,4.79</span><br><span class="line">18,Downstairs,103260365577000,-6.32,8.66,4.94</span><br><span class="line">18,Downstairs,103260403083000,-5.37,11.22,3.06</span><br><span class="line">18,Downstairs,103260443305000,-5.79,9.92,2.53</span><br></pre></td></tr></table></figure>

<p><strong>我的代码</strong> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"></span><br><span class="line">import csv</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">input_file = sys.argv[1]</span><br><span class="line">output_file = sys.argv[2]</span><br><span class="line"></span><br><span class="line">with open(input_file, &apos;r&apos;, newline=&apos;&apos;) as csv_in_file:</span><br><span class="line">    with open(output_file, &apos;w&apos;, newline=&apos;&apos;) as csv_out_file:</span><br><span class="line">        filereader = csv.reader(csv_in_file, delimiter=&apos; &apos;)</span><br><span class="line">        filewriter = csv.writer(csv_out_file)</span><br><span class="line">        for row_list in filereader:</span><br><span class="line">            if len(row_list) == 6 and row_list[2] != &apos;0&apos;:</span><br><span class="line">                filewriter.writerow(row_list)</span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;处理一是一个数据清洗的过程。输出文件的要求是“每行单个元素以逗号为分隔”，这不难让人想到要使用CSV逗号分隔值文件。首先对输入文件和输出文件进行打开操作，然后使用csv模块的<code>reader()</code>和<code>writer()</code>函数分别创建了两个对象<code>filereader</code>和<code>filewriter</code>。因为输入文件的每行的单个元素都以空格分隔，因此我们在创建对象<code>filereader</code>的时候，需要把<code>reader()</code>函数的<code>delimiter</code>参数设置为<code>delimiter=&#39; &#39;</code>，表示以空格作为分隔符。<br>&emsp;&emsp;我们来分析一下数据样本。样本中有问题的数据行有两种，一种类似于上面输入数据样例的第4行数据，缺少数据元素；另一种类似于输入数据样例的最后一行数据，第3列的数据元素为0。针对第一类问题，我们可以通过判断列表长度的方法将其筛掉，即判断<code>len(row_list)</code>是否为6。而对于第二类问题，我们只需要判断<code>row_list</code>列表中索引为2的元素是否为<code>&#39;0&#39;</code>（注意这里的0是一个字符而并非一个数字）。对于满足条件的数据行，我们将其写入输出文件。  </p>
<hr>
<p><strong>处理二</strong>：将test1数据中所有动作的数目统计出来，将动作数目打印到屏幕。然后将动作数目变为100的倍数，多余的删除，将数据行写入输出文件test2。比如统计出Jogging的数量为3021次，那么打印出3021后只往输出文件test2中写入3000条。<br><strong>我的代码</strong> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"></span><br><span class="line">import csv</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">input_file = sys.argv[1]</span><br><span class="line">output_file = sys.argv[2]</span><br><span class="line"></span><br><span class="line">movementsDict = &#123;&#125;</span><br><span class="line">inputData = []</span><br><span class="line">with open(input_file, &apos;r&apos;, newline=&apos;&apos;) as csv_in_file:</span><br><span class="line">    filereader = csv.reader(csv_in_file)</span><br><span class="line">    movementsList = []</span><br><span class="line">    for row_list in filereader:</span><br><span class="line">        movementsList.append(row_list[1])</span><br><span class="line">    for movement in movementsList:</span><br><span class="line">        if movement not in movementsDict:</span><br><span class="line">            movementsDict[movement] = 1</span><br><span class="line">        else:</span><br><span class="line">            movementsDict[movement] += 1</span><br><span class="line">    for movement, movementsDict[movement] in movementsDict.items():</span><br><span class="line">        print(&apos;Movement: %-15s&apos; % movement, end=&apos;&apos;)</span><br><span class="line">        print(&apos;Amount: &apos; + str(movementsDict[movement]))</span><br><span class="line">        movementsDict[movement] = movementsDict[movement] // 100 * 100</span><br><span class="line">        inputData.append(movementsDict[movement])</span><br><span class="line">    csv_in_file.seek(0, 0)</span><br><span class="line">    with open(output_file, &apos;w&apos;, newline=&apos;&apos;) as csv_out_file:</span><br><span class="line">        filewriter = csv.writer(csv_out_file)</span><br><span class="line">        countWalking = 0</span><br><span class="line">        countJogging = 0</span><br><span class="line">        countUpstairs = 0</span><br><span class="line">        countDownstairs = 0</span><br><span class="line">        countStanding = 0</span><br><span class="line">        countSitting = 0</span><br><span class="line">        for row_list in filereader:</span><br><span class="line">            if row_list[1] == &apos;Walking&apos;:</span><br><span class="line">                if countWalking &lt; inputData[0]:</span><br><span class="line">                    filewriter.writerow(row_list)</span><br><span class="line">                    countWalking += 1</span><br><span class="line">            elif row_list[1] == &apos;Jogging&apos;:</span><br><span class="line">                if countJogging &lt; inputData[1]:</span><br><span class="line">                    filewriter.writerow(row_list)</span><br><span class="line">                    countJogging += 1</span><br><span class="line">            elif row_list[1] == &apos;Upstairs&apos;:</span><br><span class="line">                if countUpstairs &lt; inputData[2]:</span><br><span class="line">                    filewriter.writerow(row_list)</span><br><span class="line">                    countUpstairs += 1</span><br><span class="line">            elif row_list[1] == &apos;Downstairs&apos;:</span><br><span class="line">                if countDownstairs &lt; inputData[3]:</span><br><span class="line">                    filewriter.writerow(row_list)</span><br><span class="line">                    countDownstairs += 1</span><br><span class="line">            elif row_list[1] == &apos;Standing&apos;:</span><br><span class="line">                if countStanding &lt; inputData[4]:</span><br><span class="line">                    filewriter.writerow(row_list)</span><br><span class="line">                    countStanding += 1</span><br><span class="line">            else:</span><br><span class="line">                if countSitting &lt; inputData[5]:</span><br><span class="line">                    filewriter.writerow(row_list)</span><br><span class="line">                    countSitting += 1</span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;对于计数，我们可以应用Python的字典。这和我之前写过的统计文章中单次出现的次数的程序类似。首先建立一个空字典<code>movementsDict</code>和一个空列表<code>movementsList</code>。读取文件时，每个数据行是一个具有6个元素的列表，其中索引为1的元素就是我们要计数的动作。我们把索引为1的元素加入到<code>movementsList</code>中，然后对其中的元素通过字典来计数。为了以100为精确度，我们进行<code>movementsDict[movement] = movementsDict[movement] // 100 * 100</code>的运算。在写入输出文件的时候，我采用了每个动作分别计数的策略，每写入一行就令计数器+1。当计数器变量超过给定数值的时候，停止写入。  </p>
<hr>
<p><strong>处理三</strong>：将test2中的数据读出，每行只取最后3列，每行数据中的单个元素以空格隔开，写入文件test3。<br><strong>输出test3样例</strong>  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-0.72 9.62 0.14982383</span><br><span class="line">-4.02 11.03 3.445948</span><br><span class="line">0.95 14.71 3.636633</span><br></pre></td></tr></table></figure>

<p><strong>我的代码</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"></span><br><span class="line">import csv</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">input_file = sys.argv[1]</span><br><span class="line">output_file = sys.argv[2]</span><br><span class="line"></span><br><span class="line">my_columns = [3, 4, 5]</span><br><span class="line">with open(input_file, &apos;r&apos;, newline=&apos;&apos;) as csv_in_file:</span><br><span class="line">    with open(output_file, &apos;w&apos;, newline=&apos;&apos;) as csv_out_file:</span><br><span class="line">        filereader = csv.reader(csv_in_file)</span><br><span class="line">        filewriter = csv.writer(csv_out_file, delimiter=&apos; &apos;)</span><br><span class="line">        for row_list in filereader:</span><br><span class="line">            row_list_output = []</span><br><span class="line">            for index_value in my_columns:</span><br><span class="line">                row_list_output.append(row_list[index_value])</span><br><span class="line">            filewriter.writerow(row_list_output)</span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;处理三还是比较简单的。输出文件只要求保留最后三列，即列索引值为3, 4, 5的三列。我们创建一个列表变量<code>my_columns = [3, 4, 5]</code>，用来保存要保留的列索引值。输出文件还要求各个数据元素“以空格隔开”，所以我们在创建对象<code>filewriter</code>的时候，需要把<code>writer()</code>函数的<code>delimiter</code>参数设置为<code>delimiter=&#39; &#39;</code>。空列表<code>row_list_output</code>用来保存要输出的数据行。对于满足列索引值为3, 4, 5的数据元素，将其追加到列表<code>row_list_output</code>中，并将其写入输出文件。  </p>
<hr>
<p><strong>处理四</strong>：将test3中的数据读出，每行数据的单个元素用空格隔开，数据行与数据行用逗号隔开，每20个一行写入文件finally中，保证每行不会出现不够或者多出来的情况。<br><strong>输出finally单行样例</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-0.72 9.62 0.14982383,-4.02 11.03 3.445948,0.95 14.71 3.636633,-3.57 5.75 -5.407278,-5.28 8.85 -9.615966,-1.14 15.02 -3.8681788,7.86 11.22 -1.879608,6.28 4.9 -2.3018389,0.95 7.06 -3.445948,-1.61 9.7 0.23154591,6.44 12.18 -0.7627395,5.83 12.07 -0.53119355,7.21 12.41 0.3405087,6.17 12.53 -6.701211,-1.08 17.54 -6.701211,-1.69 16.78 3.214402,-2.3 8.12 -3.486809,-2.91 0 -4.7535014,-2.91 0 -4.7535014,-4.44 1.84 -2.8330324</span><br></pre></td></tr></table></figure>

<p><strong>我的代码</strong>  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"></span><br><span class="line">import csv</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">input_file = sys.argv[1]</span><br><span class="line">output_file = sys.argv[2]</span><br><span class="line"></span><br><span class="line">with open(input_file, &apos;r&apos;, newline=&apos;&apos;) as csv_in_file:</span><br><span class="line">    with open(output_file, &apos;w&apos;, newline=&apos;&apos;) as csv_out_file:</span><br><span class="line">        filereader = csv.reader(csv_in_file)</span><br><span class="line">        filewriter = csv.writer(csv_out_file)</span><br><span class="line">        total = []</span><br><span class="line">        for row_list in filereader:</span><br><span class="line">            total.append(row_list[0])</span><br><span class="line">        outputList = []</span><br><span class="line">        a_list = []</span><br><span class="line">        a = 0</span><br><span class="line">        for data in total:</span><br><span class="line">            if a &lt; 19:</span><br><span class="line">                a += 1</span><br><span class="line">                a_list.append(data)</span><br><span class="line">            else:</span><br><span class="line">                a_list.append(data)</span><br><span class="line">                outputList.append(a_list)</span><br><span class="line">                a = 0</span><br><span class="line">                a_list = []</span><br><span class="line">        for output_line in outputList:</span><br><span class="line">            filewriter.writerow(output_line)</span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;第13行代码创建了空列表<code>total</code>，用来保存所有的数据行。第16-17行则是把数据行添加到<code>total</code>中的过程。第18行创建了空列表<code>outputList</code>，用来把<code>total</code>中的数据每20个一组进行拆分。第19行创建的<code>a_list</code>是辅助拆分列表的列表变量。<code>a</code>则是一个计数器变量。<br>&emsp;&emsp;遍历列表<code>total</code>，当<code>a</code>小于19时，<code>a</code>自加1，然后把<code>data</code>添加到<code>a_list</code>中。当<code>a</code>等于19时，再把<code>data</code>添加到<code>a_list</code>之后，<code>a_list</code>的长度为20，这时就需要把<code>a_list</code>添加到<code>outputList</code>中，然后将<code>a</code>归零，将<code>a_list</code>清空，继续下一轮拆分。拆分完成之后，逐行写入输出文件即可。  </p>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2020/02/13/%E8%87%AA%E5%AD%A6%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E2%80%94%E2%80%94%E7%AE%97%E6%B3%95/">
                自学数据结构与算法——算法
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2020-02-13</span>
            
            
            
        </div>
    </div>

    
        <div class="content">
            <p>&emsp;&emsp;我正在学习的这门课程名叫“数据结构与算法”，这样看来，它们二者一定是有着某种关联。事实上，在学习数据结构的过程中，谈到“算法”是为了帮我们更好地理解数据结构。单说数据结构当然可以，在很短的时间内我们就可以学习完几种重要的数据结构。但是这样的话，我们学完后不会有什么感觉，也不知道数据结构有何作用。下面主要讨论一下有关算法的方方面面。  </p>
<h2 id="两种算法的比较"><a href="#两种算法的比较" class="headerlink" title="两种算法的比较"></a>两种算法的比较</h2><p>&emsp;&emsp;在之前，无论是学习C语言也好，学习Python也好，学习Java也好，我们一定写过这样一个程序：1-100求和。这是一个再简单不过的程序，我们也很快能写出这样的代码：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">int main(void) &#123;</span><br><span class="line">	int i, sum = 0;</span><br><span class="line">	for (i = 1; i &lt;= 100; i++) &#123;</span><br><span class="line">		sum += i;</span><br><span class="line">	&#125;</span><br><span class="line">	printf(&quot;%d\n&quot;, sum);</span><br><span class="line">	return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;这个简单的程序就是一种算法。程序本身没有什么需要解释的地方，就是应用了一个<code>for</code>循环来对1-100这些数字进行累加。我相信这也是大多数人拿到这个题目的第一想法。<br>&emsp;&emsp;相信很多人都听说过数学家高斯的一个故事。老师让所有的学生计算1+2+3+…+100的结果，这道题难倒了很多学生，但只有高斯很快地算出了结果。这让老师非常惊讶（可能老师也是通过1+2=3, 3+3=6, 6+4=10…这样的方法来计算的吧）。当被问到怎么样能如此快地计算出结果的时候，高斯解释道：  </p>
<center>∵ sum = 1 + 2 + 3 + ... + 99 + 100</center>
<center>又∵ sum = 100 + 99 + 98 + ... + 2 + 1</center>
<center>∴ 2 × sum = 101 + 101 + 101 + ... + 101 = 100 × 101</center>
<center>∴ sum = 5050</center>

<p>&emsp;&emsp;高斯用的方法相当于求等差数列前n项和的方法，用代码实现如下：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">int main(void) &#123;</span><br><span class="line">	int n = 100, sum = 0;</span><br><span class="line">	sum = (1 + n) * n / 2;</span><br><span class="line">	printf(&quot;%d\n&quot;, sum);</span><br><span class="line">	return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;这个程序并没有用到循环。试想一下，如果我们要对1至1亿的所有数字进行求和（当然，这里的int要替换为长整型），如果用循环的方法，计算机要进行1亿次的循环累加，而应用高斯求和的方法，计算机运算出结果只是一瞬间的事。这大大节省了计算机运算的时间。  </p>
<h2 id="什么是算法"><a href="#什么是算法" class="headerlink" title="什么是算法"></a>什么是算法</h2><p>&emsp;&emsp;前面说了这么多，我们似乎还是摸不清头脑，什么是算法呢？<br>&emsp;&emsp;现在普遍认可的定义是：<strong>算法</strong>（Algorithm）是解决特定问题求解步骤的描述，在计算机中表现为指令的有限序列，并且每条指令表示一个或多个操作。<br>&emsp;&emsp;在算法的定义中提到了指令。指令能被人或机器等计算装置执行，它可以是计算机指令，也可以是我们平时的语言文字。为了解决某个或某类问题，需要把指令表示成一定的操作序列，操作序列包括一组操作，每一个操作都完成特定的功能，这就是算法。  </p>
<h2 id="算法的特性"><a href="#算法的特性" class="headerlink" title="算法的特性"></a>算法的特性</h2><p>&emsp;&emsp;算法具有5个基本特性：输入，输出，有穷性，确定性，可行性。  </p>
<h4 id="输入"><a href="#输入" class="headerlink" title="输入"></a>输入</h4><p>&emsp;&emsp;算法具有零个，一个或多个输入。对于大多数算法来说，输入是必要的，但也有个别算法不需要输入任何参数。  </p>
<h4 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h4><p>&emsp;&emsp;算法至少有一个或多个输出，输出的形式可以是打印输出，也可以是返回一个或多个值等。  </p>
<h4 id="有穷性"><a href="#有穷性" class="headerlink" title="有穷性"></a>有穷性</h4><p>&emsp;&emsp;算法在执行有限的步骤之后，自动结束而不会出现无限循环，并且每一个步骤在可接受的时间内完成。这里的“有穷”并不是纯数学意义的，它更多是指在实际应用当中合理的、可以接受的“有边界”。  </p>
<h4 id="确定性"><a href="#确定性" class="headerlink" title="确定性"></a>确定性</h4><p>&emsp;&emsp;算法的每一步骤都具有确定的含义，不会出现二义性。算法在一定条件下，只有一条执行路径，相同的输入只能有唯一的输出结果。算法的每个步骤被精确定义而无歧义。  </p>
<h4 id="可行性"><a href="#可行性" class="headerlink" title="可行性"></a>可行性</h4><p>&emsp;&emsp;算法的每一步都必须是可行的，也就是说，每一步都能够通过执行有限次数完成。可行性意味着算法可以转换为程序上机运行，并得到正确的结果。  </p>
<h2 id="算法设计的要求"><a href="#算法设计的要求" class="headerlink" title="算法设计的要求"></a>算法设计的要求</h2><p>&emsp;&emsp;算法设计有以下几个要求：正确性，可读性，健壮性，时间效率高和存储量低。  </p>
<h4 id="正确性"><a href="#正确性" class="headerlink" title="正确性"></a>正确性</h4><p>&emsp;&emsp;一个好的算法，最起码得是正确的。如果连正确都谈不上，再谈别的要求也没有意义。<br>&emsp;&emsp;算法的正确性是指算法至少应该具有输入、输出和加工处理无歧义性、能正确反映问题的需求，能够得到问题的正确答案。“正确”大体分为以下4个层次：<br>&emsp;&emsp;1.算法程序没有语法错误。<br>&emsp;&emsp;2.算法程序对于合法的输入数据能够产生满足要求的输出结果。<br>&emsp;&emsp;3.算法程序对于非法的输入数据能够得出满足规格说明的结果。<br>&emsp;&emsp;4.算法程序对于精心选择的，甚至刁难的测试数据都有满足要求的输出结果。<br>&emsp;&emsp;一般情况下，我们把层次3作为一个算法是否正确的标准。  </p>
<h4 id="可读性"><a href="#可读性" class="headerlink" title="可读性"></a>可读性</h4><p>&emsp;&emsp;算法设计的另一目的是为了便于阅读、理解和交流。可读性高有助于人们理解算法，晦涩难懂的算法往往隐含错误，不易被发现，并且难于调试和修改。<br>&emsp;&emsp;我们写代码的目的，一方面是为了让计算机执行，另一个很重要的方面是为了便于他人阅读，让人理解和交流。自己将来也有可能阅读自己的代码，如果可读性不好的话，时间长了自己都不知道写了些什么。由此可见，可读性是算法（包括实现它的代码）好坏的很重要的标准。  </p>
<h4 id="健壮性"><a href="#健壮性" class="headerlink" title="健壮性"></a>健壮性</h4><p>&emsp;&emsp;一个好的算法应该能对输入数据不合法的情况做合适的处理。当输入数据不合法时，算法也能做出相关处理，而不是产生异常或莫名奇妙的结果。  </p>
<h4 id="时间效率高和存储量低"><a href="#时间效率高和存储量低" class="headerlink" title="时间效率高和存储量低"></a>时间效率高和存储量低</h4><p>&emsp;&emsp;好的算法还应该具备时间效率高和存储量低的特点。时间效率指的是算法的执行时间，执行时间短的算法效率高。存储量需求指的是算法在执行过程中需要的最大存储空间，主要指算法程序运行时所占用的内存或外部硬盘存储空间。设计算法应该尽量满足时间效率高和存储量低的需求。</p>
<h2 id="算法效率的度量方法"><a href="#算法效率的度量方法" class="headerlink" title="算法效率的度量方法"></a>算法效率的度量方法</h2><p>&emsp;&emsp;我们如何度量一个算法的执行时间呢？很简单，我们通过对算法的数据测试，利用计算机的计时功能，来计算不同算法的效率是高还是低。  </p>
<h4 id="事后统计方法"><a href="#事后统计方法" class="headerlink" title="事后统计方法"></a>事后统计方法</h4><p>&emsp;&emsp;<strong>事后统计方法</strong>主要是通过设计好的测试程序和数据，利用计算机计时器对不同算法编制的程序的运行时间进行比较，从而确定算法效率的高低。<br>&emsp;&emsp;但是这种方法具有很大的缺陷。如果我们花费了大量的时间和精力，最后编制出算法之后发现它根本就是很糟糕的，就会造成“竹篮打水一场空”的尴尬。<br>&emsp;&emsp;除此之外，算法的测试数据设计困难，而且程序运行时间也跟测试数据的规模大小密切相关。计算机的硬件、软件等环境因素有时也会掩盖算法本身的优劣。<br>&emsp;&emsp;综上所述，我们一般不采纳事后统计方法。  </p>
<h4 id="事前分析估算方法"><a href="#事前分析估算方法" class="headerlink" title="事前分析估算方法"></a>事前分析估算方法</h4><p>&emsp;&emsp;<strong>事前分析估算方法</strong>是指在计算机程序编制前依据统计方法对算法进行估算。一个用高级程序语言编写的程序在计算机上运行时所消耗的时间取决于下列因素：<br>&emsp;&emsp;1.算法采用的策略、方法。<br>&emsp;&emsp;2.编译产生的代码质量。<br>&emsp;&emsp;3.问题的输入规模。<br>&emsp;&emsp;4.机器执行指令的速度。<br>&emsp;&emsp;第1条当然是算法好坏的根本，第2条要由软件来支持，第4条要看硬件性能。抛开这些与计算机硬件、软件有关的因素，一个程序的运行时间，依赖于<strong>算法的好坏</strong>和<strong>问题的输入规模</strong>。所谓问题输入规模，就是指输入量的多少。<br>&emsp;&emsp;我们还是拿1-100求和这个问题举例子。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 算法1：循环求和</span><br><span class="line">int i, sum = 0;                 // 执行1次</span><br><span class="line">for (i = 1; i &lt;= 100; i++) &#123;    // 执行(n+1)次</span><br><span class="line">	sum += i;                   // 执行n次</span><br><span class="line">&#125;</span><br><span class="line">printf(&quot;%d\n&quot;, sum);            // 执行1次</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 算法2：高斯求和</span><br><span class="line">int n = 100, sum = 0;           // 执行1次</span><br><span class="line">sum = (1 + n) * n / 2;          // 执行1次</span><br><span class="line">printf(&quot;%d\n&quot;, sum);            // 执行1次</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;循环求和算法执行了[1+(n+1)+n+1]次=(2n+3)次，而高斯求和算法执行了(1+1+1)次=3次。事实上，两个算法的第一条和最后一条语句是一样的，我们关注的代码其实是中间的部分。我们把循环看作一个整体，忽略头尾循环判断的开销，那么这两个算法其实就是n次与1次的差距。<br>&emsp;&emsp;我们不关心编写程序使用了什么语言，也不关心这些程序将会在什么样的计算机中运行，我们只关心它所实现的算法。在分析程序的运行时间时，最重要的是把程序看成是独立于程序设计语言的算法或一系列步骤。<br><img src="https://img-blog.csdnimg.cn/20200213165851207.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>&emsp;&emsp;由上图可以明显看出，随着n的不断增大，它们在时间效率上的差异也就越来越大。  </p>
<h2 id="函数的渐进增长"><a href="#函数的渐进增长" class="headerlink" title="函数的渐进增长"></a>函数的渐进增长</h2><p>&emsp;&emsp;给定两个函数f(n)和g(n)，如果存在一个整数N，使得对于所有的n&gt;N，f(n)总是比g(n)大，那么，我们说f(n)的增长渐进快于g(n)。也就是说，输入规模n在没有限制的情况下，只要超过一个数值N，这个函数就总是大于另一个函数，我们称函数是渐进增长的。<br>&emsp;&emsp;判断一个算法的效率时，函数中的常数和其他次要项常常可以忽略，而更应该关注主项（最高阶项）的阶数。某个算法，随着n的增大，它会越来越优于另一算法，或者越来越差于另一算法。  </p>
<h2 id="时间复杂度"><a href="#时间复杂度" class="headerlink" title="时间复杂度"></a>时间复杂度</h2><h4 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h4><p>&emsp;&emsp;在进行算法分析时，语句总的执行次数T(n)是关于问题规模n的函数，进而分析T(n)随n的变化情况并确定T(n)的数量级。算法的时间复杂度，也就是算法的时间量度，记作：T(n)=O(f(n))。它表示随问题规模n的增大，算法执行时间的增长率和f(n)的增长率相同，称作算法的渐进时间复杂度，简称为时间复杂度。其中f(n)是问题规模n的某个函数。<br>&emsp;&emsp;这样用大写O()来体现算法时间复杂度的记法，我们称之为大O记法。<br>&emsp;&emsp;一般情况下，随着n的增大，T(n)增长最慢的算法为最优算法。  </p>
<h4 id="推导大O阶方法"><a href="#推导大O阶方法" class="headerlink" title="推导大O阶方法"></a>推导大O阶方法</h4><p>&emsp;&emsp;1.用常数1取代运行时间中的所有加法常数。<br>&emsp;&emsp;2.在修改后的运行次数函数中，只保留最高阶项。<br>&emsp;&emsp;3.如果最高阶项存在且不是1，则去除与这个项相乘的函数。<br>&emsp;&emsp;经过上述3步运算，得到的结果就是大O阶。  </p>
<h4 id="常数阶"><a href="#常数阶" class="headerlink" title="常数阶"></a>常数阶</h4><p>&emsp;&emsp;我们还是以高斯求和算法为例。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">int n = 100, sum = 0;           // 执行1次</span><br><span class="line">sum = (1 + n) * n / 2;          // 执行1次</span><br><span class="line">printf(&quot;%d\n&quot;, sum);            // 执行1次</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;这个算法的运行次数函数是f(n)=3。根据推导大O阶的方法，第1步，我们把常数项3改为1。它没有最高阶项，所以这个算法的时间复杂度为O(1)。<br>&emsp;&emsp;这种与问题的大小无关（n的多少），执行时间恒定的算法，我们称之为具有O(1)的时间复杂度，又叫常数阶。不管这个常数是多少，我们都记作O(1)，括号里不能是其他任何数字。<br>&emsp;&emsp;对于分支结构而言，无论是真还是假，执行的次数都是恒定的，不会随着n的变大而发生变化，所以单纯的分支结构（不包含在循环结构中），其时间复杂度也是O(1)。  </p>
<h4 id="线性阶"><a href="#线性阶" class="headerlink" title="线性阶"></a>线性阶</h4><p>&emsp;&emsp;下面这段代码，它的循环的时间复杂度为O(n)，因为循环体中的代码执行了n次。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">int i;</span><br><span class="line">for (i = 0; i &lt; n; i++) &#123;</span><br><span class="line">    /* 时间复杂度为O(1)的程序步骤序列 */</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="对数阶"><a href="#对数阶" class="headerlink" title="对数阶"></a>对数阶</h4><p>&emsp;&emsp;我们再来看一段代码：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">int count = 1;</span><br><span class="line">while (count &gt; n) &#123;</span><br><span class="line">    count = count * 2;</span><br><span class="line">    /* 时间复杂度为O(1)的程序步骤序列 */</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;由于每次<code>count</code>乘以2之后，就距离n更近了一分，也就是说，有多少个2相乘后大于n，则会退出循环。由$$2^x=n$$可得$$x=log_2n.$$所以这个循环的时间复杂度为O(logn)。  </p>
<h4 id="平方阶"><a href="#平方阶" class="headerlink" title="平方阶"></a>平方阶</h4><p>&emsp;&emsp;下面的例子是一个循环嵌套：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">int i, j;</span><br><span class="line">for (i = 0; i &lt; n; i++) &#123;</span><br><span class="line">    for (j = 0; j &lt; n; j++) &#123;</span><br><span class="line">        /* 时间复杂度为O(1)的程序步骤序列 */</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;刚才我们分析过，内循环的时间复杂度为O(n)。而对于外层的循环，其实就是内层的时间复杂度为O(n)的语句再循环n次。所以这段代码的时间复杂度为O(n^2^)。<br>&emsp;&emsp;我们对上面的代码稍作修改：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">int i, j;</span><br><span class="line">for (i = 0; i &lt; m; i++) &#123;</span><br><span class="line">    for (j = 0; j &lt; n; j++) &#123;</span><br><span class="line">        /* 时间复杂度为O(1)的程序步骤序列 */</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;在这段代码中，外循环的循环次数改为了m，那么时间复杂度就变为O(m×n)。<br>&emsp;&emsp;我们可以总结得出：<strong>循环的时间复杂度=循环体的复杂度×该循环运行的次数</strong>。<br>&emsp;&emsp;我们再来看一个循环嵌套：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">int i, j;</span><br><span class="line">for (i = 0; i &lt; n; i++) &#123;</span><br><span class="line">    for (j = i; j &lt; n; j++) &#123;</span><br><span class="line">        /* 时间复杂度为O(1)的程序步骤序列 */</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;当i=0时，内循环执行了n次；当i=1时，内循环执行了(n-1)次……当i=n-1时，内循环执行了一次。所以有总的执行次数为$$n+(n-1)+(n-2)+…+1=\frac{n(n+1)}{2}=\frac{n^2}{2}+\frac{n}{2}.$$<br>&emsp;&emsp;用推导大O阶的方法，最终这段代码的时间复杂度为O(n^2^)。<br>&emsp;&emsp;接下来我们来看一段相对复杂的代码：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">void function(int count) &#123;</span><br><span class="line">    int j;</span><br><span class="line">    for (j = count; j &lt; n; j++) &#123;</span><br><span class="line">        /* 时间复杂度为O(1)的程序步骤序列 */</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">n++;</span><br><span class="line">function(n);</span><br><span class="line">int i, j;</span><br><span class="line">for (i = 0; i &lt; n; i++) &#123;</span><br><span class="line">    function(i);</span><br><span class="line">&#125;</span><br><span class="line">for (i = 0; i &lt; n; i++) &#123;</span><br><span class="line">    for (j = i; j &lt; n; j++) &#123;</span><br><span class="line">        /* 时间复杂度为O(1)的程序步骤序列 */</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;函数<code>function()</code>的时间复杂度为O(n)。为了方便，我们把代码的下半部分单独拿出来，注释上每条语句的执行次数。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">n++;                              // 执行次数为1</span><br><span class="line">function(n);                      // 执行次数为n</span><br><span class="line">int i, j;</span><br><span class="line">for (i = 0; i &lt; n; i++) &#123;         // 执行次数为n×n</span><br><span class="line">    function(i);</span><br><span class="line">&#125;</span><br><span class="line">for (i = 0; i &lt; n; i++) &#123;         // 执行次数为n(n+1)/2</span><br><span class="line">    for (j = i; j &lt; n; j++) &#123;</span><br><span class="line">        /* 时间复杂度为O(1)的程序步骤序列 */</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;由上面的分析可得$$f(n)=1+n+n^2+\frac{n(n+1)}{2}=\frac{3}{2}n^2+\frac{3}{2}n+1.$$根据推导大O阶的方法，最终这段代码的时间复杂度也是O(n^2^)。  </p>
<h2 id="常见的时间复杂度"><a href="#常见的时间复杂度" class="headerlink" title="常见的时间复杂度"></a>常见的时间复杂度</h2><p>&emsp;&emsp;常见的时间复杂度如下表所示。<br>执行次数函数|阶|非正式术语<br>——|——|——<br>12|O(1)|常数阶<br>2n+3|O(n)|线性阶<br>3n^2^+2n+1|O(n^2^)|平方阶<br>5log<del>2</del>n+20|O(logn)|对数阶<br>2n+3nlog<del>2</del>n+19|O(nlogn)|nlogn阶<br>6n^3^+2n^2^+3n+4|O(n^3^)|立方阶<br>2^n^|O(2^n^)|指数阶</p>
<p>&emsp;&emsp;常用的时间复杂度所耗费的时间从小到大依次是：O(1)&lt;O(logn)&lt;O(n)&lt;O(nlogn)&lt;O(n^2^)&lt;O(n^3^)&lt;O(2^n^)&lt;O(n!)&lt;O(n^n^)。<br>&emsp;&emsp;O(n^3^)之后的时间复杂度，过大的n都会使结果变得不现实。尤其是指数阶和阶乘阶等，除非n很小，否则就是噩梦般的运行时间。这种时间复杂度是不切实际的，我们一般不去讨论它。  </p>
<h2 id="最坏情况与平均情况"><a href="#最坏情况与平均情况" class="headerlink" title="最坏情况与平均情况"></a>最坏情况与平均情况</h2><p>&emsp;&emsp;比如说我们查找一个有n个随机数字数组中的某个数字，最好的情况是第一个数字就是我们要找的数字，那么算法的时间复杂度为O(1)。最坏的情况就是我们要找的数字在数组的最后一个位置上，那么算法的时间复杂度就是O(n)。这就像我们在日常生活中找东西，运气好的话我们可以一下找到，不会花费太长时间；运气不好的话，我们怎么也找不到，花费的时间也是相当长。<br>&emsp;&emsp;最坏情况运行时间是一种保证，那就是运行时间将不会再长了。在应用中，这是一种最重要的需求，通常，除非特别指定，我们提到的运行时间都是最坏情况的运行时间。<br>&emsp;&emsp;平均运行时间是所有情况中最有意义的，因为它是期望的运行时间。从概率的角度看，这个数字在每一个位置的可能性是相同的，所以平均的查找时间为n/2次后发现这个目标元素。<br>&emsp;&emsp;一般在没有特殊说明的情况下，时间复杂度指最坏时间复杂度。  </p>
<h2 id="空间复杂度"><a href="#空间复杂度" class="headerlink" title="空间复杂度"></a>空间复杂度</h2><p>&emsp;&emsp;算法的空间复杂度通过计算算法所需的存储空间实现，算法空间复杂度的计算公式记作S(n)=O(f(n))，其中，n为问题的规模，f(n)为语句关于n所占存储空间的函数。<br>&emsp;&emsp;我们在写代码时，可以用空间来换取时间。<br>&emsp;&emsp;一般情况下，一个程序在机器上执行时，除了需要存储程序本身的指令、常数、变量和输入数据外，还需要存储对数据操作的存储单元。若输入数据所占空间只取决于问题本身，和算法无关，这样只需要分析该算法在实现时所需的辅助单元即可。若算法执行时所需的辅助空间相对于输入数据量而言是个常数，则称此算法为原地工作，空间复杂度为O(1)。  </p>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2020/02/12/%E8%87%AA%E5%AD%A6%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E2%80%94%E2%80%94%E7%BB%AA%E8%AE%BA/">
                自学数据结构与算法——绪论
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2020-02-12</span>
            
            
            
        </div>
    </div>

    
        <div class="content">
            <blockquote>
<p>参考资料：《大话数据结构》，作者程杰，清华大学出版社  </p>
</blockquote>
<h2 id="什么是数据结构"><a href="#什么是数据结构" class="headerlink" title="什么是数据结构"></a>什么是数据结构</h2><p>&emsp;&emsp;数据结构是一门研究非数值计算的程序设计问题中的操作对象，以及它们之间的关系和操作等相关问题的学科。这里不得不提一个著名的公式：<strong>程序设计=数据结构+算法</strong>。<br>&emsp;&emsp;在说数据结构之前，我们应该先要了解什么是数据。<strong>数据</strong>是描述客观事物的符号，是计算机中可以操作的对象，是能被计算机识别，并输入给计算机处理的符号集合。数据包括整型、实型等<strong>数值类型</strong>，也包括字符、声音、图像、视频等<strong>非数值类型</strong>。也就是说，这里所说的数据其实就是符号，他们具备两个前提：<strong>可以输入到计算机中</strong>，<strong>能被计算机程序处理</strong>。<br>&emsp;&emsp;<strong>数据元素</strong>是组成数据的、有一定意义的基本单位，在计算机中通常作为整体处理，也被称为<strong>记录</strong>。一个数据元素可以由若干个<strong>数据项</strong>组成。举个简单的例子，在人类中，人就是数据元素，而人的眼睛、耳朵、鼻子、手、脚等就是数据项，人的姓名、性别、年龄、联系方式等也可以是数据项。具体有哪些数据项，要视系统而决定。<strong>数据项是数据不可分割的最小单位</strong>。<br>&emsp;&emsp;<strong>数据对象</strong>是性质相同的数据元素的集合，是数据的子集。<br><img src="https://img-blog.csdnimg.cn/20200212213008839.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>&emsp;&emsp;以上说的这么多都属于数据的范畴，接下来我们来说一下什么是结构。<br>&emsp;&emsp;简单来说，结构就是关系。而严格来说，<strong>结构</strong>是指各个组成部分相互搭配和排列的方式。不同数据元素之间不是独立的，而是存在特定的关系。<br>&emsp;&emsp;说了这么多，<strong>数据结构</strong>就是相互之间存在一种或多种特定关系的数据元素的集合。在计算机中，数据元素并不是孤立、杂乱无序的，而是具有内在联系的数据集合。数据元素之间存在的一种或多种特定关系，也就是数据的组织形式。  </p>
<h2 id="逻辑结构和物理结构"><a href="#逻辑结构和物理结构" class="headerlink" title="逻辑结构和物理结构"></a>逻辑结构和物理结构</h2><p>&emsp;&emsp;数据结构分为<strong>逻辑结构</strong>和<strong>物理结构</strong>。<br><img src="https://img-blog.csdnimg.cn/20200212210205553.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>&emsp;&emsp;逻辑结构是指数据对象中数据元素之间的相互关系，分为以下四种：<br>&emsp;&emsp;1.集合结构：集合结构中的数据元素除了<strong>同属于一个集合</strong>外，它们之间<strong>没有其它关系</strong>。它类似于数学中的集合。如下图所示。<br><img src="https://img-blog.csdnimg.cn/20200212210631112.png" alt="在这里插入图片描述"><br>&emsp;&emsp;2.线性结构：线性结构中的数据元素之间是<strong>一对一</strong>的关系。如下图所示。<br><img src="https://img-blog.csdnimg.cn/20200212210603680.png" alt="在这里插入图片描述"><br>&emsp;&emsp;3.树形结构：树型结构中的数据元素之间存在一种<strong>一对多</strong>的层次关系。如下图所示。<br><img src="https://img-blog.csdnimg.cn/20200212210744649.png" alt="在这里插入图片描述"><br>&emsp;&emsp;4.图形结构：图形结构的数据元素是<strong>多对多</strong>的关系。如下图所示。<br><img src="https://img-blog.csdnimg.cn/2020021221085452.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>&emsp;&emsp;说完了逻辑结构，我们再来说一说物理结构（也叫存储结构）。物理结构是指数据的逻辑结构在计算机中的存储形式。它分为以下两种结构：<br>&emsp;&emsp;1.顺序存储结构：是把数据元素存放在地址连续的存储单元里，其数据间的逻辑关系和物理关系是一致的。数组就是这样的顺序存储结构。顺序存储结构如下图所示。<br><img src="https://img-blog.csdnimg.cn/20200212211255349.png" alt="在这里插入图片描述"><br>&emsp;&emsp;2.链式存储结构：是把数据元素存放在任意的存储单元里，这组存储单元可以是连续的，也可以是不连续的。数据元素的存储关系并不能反映其逻辑关系，因此需要用一个指针存放数据元素的地址，通过地址就可以找到相关联数据元素的位置。链式存储结构如下图所示。<br><img src="https://img-blog.csdnimg.cn/20200212211541182.png" alt="在这里插入图片描述"></p>
<h2 id="抽象数据类型"><a href="#抽象数据类型" class="headerlink" title="抽象数据类型"></a>抽象数据类型</h2><p>&emsp;&emsp;<strong>数据类型</strong>是指一组性质相同的值的集合及定义在此集合上的一些操作的总称。数据类型按照值的不同进行划分。在高级语言中，每个变量、常量和表达式都有各自的取值范围。类型用来说明变量或表达式的取值范围和所能进行的操作。<br>&emsp;&emsp;在C语言中，按照取值的不同，数据类型可以分为两类。一类是<strong>原子类型</strong>，它是<strong>不可以再分解</strong>的基本类型，包括整型、实型、字符型等。另一类是<strong>结构类型</strong>，它由若干个类型组合而成，是<strong>可以再分解</strong>的，比如整型数组就是由若干个整型数据组成的。<br>&emsp;&emsp;<strong>抽象数据类型</strong>（Abstract Data Type, ADT）是指一个数学模型及定义在该模型上的一组操作。抽象数据类型的定义仅取决于它的一组逻辑特性，而与其在计算机内部如何表示和实现无关。“抽象”的意义在于数据类型的数学抽象特性。事实上，抽象数据类型<strong>体现了程序设计中问题分解、抽象和信息隐藏的特性</strong>。<br>&emsp;&emsp;下面给出了描述抽象数据类型的标准格式。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ADT 抽象数据类型名</span><br><span class="line">Data</span><br><span class="line">    数据元素之间逻辑关系的定义</span><br><span class="line">Operation</span><br><span class="line">    操作1</span><br><span class="line">        初始条件</span><br><span class="line">        操作结果描述</span><br><span class="line">    操作2</span><br><span class="line">        ……</span><br><span class="line">    操作n</span><br><span class="line">        ……</span><br><span class="line">endADT</span><br></pre></td></tr></table></figure>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2020/02/11/Python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%BA%93(3)/">
                Python数据分析基础之数据库(3)
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2020-02-11</span>
            
            
            
        </div>
    </div>

    
        <div class="content">
            <h2 id="查询一个表并将输出写入CSV文件"><a href="#查询一个表并将输出写入CSV文件" class="headerlink" title="查询一个表并将输出写入CSV文件"></a>查询一个表并将输出写入CSV文件</h2><p>&emsp;&emsp;数据表中有了数据之后，最常见的下一个步骤就是使用查询从表中取出一组数据进行分析。使用Python脚本可以从数据表中查询出一组特定记录。<br>&emsp;&emsp;下面的代码会从<code>Suppliers</code>数据表中查询出<code>Cost</code>列中的值大于700.00的所有记录，并将这些记录所有列中的值输出。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"></span><br><span class="line">import csv</span><br><span class="line">import MySQLdb</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line"># CSV输出文件的路径和文件名</span><br><span class="line">output_file = sys.argv[1]</span><br><span class="line"></span><br><span class="line"># 连接MySQL数据库</span><br><span class="line">con = MySQLdb.connect(host=&apos;localhost&apos;, port=3306, db=&apos;my_suppliers&apos;, user=&apos;root&apos;, passwd=&apos;## your password ##&apos;)</span><br><span class="line">c = con.cursor()</span><br><span class="line"></span><br><span class="line"># 创建写文件的对象，并写入标题行</span><br><span class="line">filewriter = csv.writer(open(output_file, &apos;w&apos;, newline=&apos;&apos;), delimiter=&apos;,&apos;)</span><br><span class="line">header = [&apos;Supplier Name&apos;, &apos;Invoice Number&apos;, &apos;Part Number&apos;, &apos;Cost&apos;, &apos;Purchase Date&apos;]</span><br><span class="line">filewriter.writerow(header)</span><br><span class="line"></span><br><span class="line"># 查询Suppliers表，并将结果写入CSV输出文件</span><br><span class="line">c.execute(&quot;&quot;&quot;SELECT *</span><br><span class="line">             FROM Suppliers</span><br><span class="line">             WHERE Cost &gt; 700.0;&quot;&quot;&quot;)</span><br><span class="line">rows = c.fetchall()</span><br><span class="line">for row in rows:</span><br><span class="line">    filewriter.writerow(row)</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;在命令行窗口中运行这个脚本，得到CSV输出文件。<br><img src="https://img-blog.csdnimg.cn/20200211181715793.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h2 id="更新表中记录"><a href="#更新表中记录" class="headerlink" title="更新表中记录"></a>更新表中记录</h2><p>&emsp;&emsp;更新表中记录的方法与之前的插入新记录的方法类似，只是SQL语句有所变化，将<code>INSERT</code>语句变为了<code>UPDATE</code>语句。代码如下：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"></span><br><span class="line">import csv</span><br><span class="line">import MySQLdb</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line"># CSV输入文件的路径和文件名</span><br><span class="line">input_file = sys.argv[1]</span><br><span class="line"></span><br><span class="line"># 连接MySQL数据库</span><br><span class="line">con = MySQLdb.connect(host=&apos;localhost&apos;, port=3306, db=&apos;my_suppliers&apos;, user=&apos;root&apos;, passwd=&apos;## your password ##&apos;)</span><br><span class="line">c = con.cursor()</span><br><span class="line"></span><br><span class="line"># 读取CSV文件并更新特定的行</span><br><span class="line">file_reader = csv.reader(open(input_file, &apos;r&apos;, newline=&apos;&apos;), delimiter=&apos;,&apos;)</span><br><span class="line">header = next(file_reader, None)</span><br><span class="line">for row in file_reader:</span><br><span class="line">    data = []</span><br><span class="line">    for column_index in range(len(header)):</span><br><span class="line">        data.append(str(row[column_index]).strip())</span><br><span class="line">    print(data)</span><br><span class="line">    c.execute(&quot;&quot;&quot;UPDATE Suppliers SET Cost=%s, Purchase_Date=%s WHERE Supplier_Name=%s;&quot;&quot;&quot;, data)</span><br><span class="line">con.commit()</span><br><span class="line"></span><br><span class="line"># 查询Suppliers表</span><br><span class="line">c.execute(&quot;SELECT * FROM Suppliers&quot;)</span><br><span class="line">rows = c.fetchall()</span><br><span class="line">for row in rows:</span><br><span class="line">    output = []</span><br><span class="line">    for column_index in range(len(row)):</span><br><span class="line">        output.append(str(row[column_index]))</span><br><span class="line">    print(output)</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;在<code>UPDATE</code>语句中，必须指定想要更新哪一条记录和哪一个列属性。在这里，我们想为一组特定的Supplier Names更新Cost值和Purchase Date值。<code>UPDATE</code>语句中需要几个值，就需要几个<code>%s</code>占位符表示出查询中的值的位置，CSV输入文件中数据的顺序也要同查询中属性的顺序一样。<br>&emsp;&emsp;现在我们新建一个CSV输入文件：<br><img src="https://img-blog.csdnimg.cn/20200211204909672.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>&emsp;&emsp;在命令行窗口中运行这个脚本，得到输出结果如下：<br><img src="https://img-blog.csdnimg.cn/20200211205045296.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>&emsp;&emsp;输出结果的前两行展示了来自于CSV输入文件中除标题行之外的两行数据。在这两行下面，输出展示了执行更新之后从数据表中取出的12行数据，每行数据占一行。<br>&emsp;&emsp;下面我们来确认一下MySQL数据表中与Supplier X和Supplier Y相关的8行数据是否已被更新。打开MySQL命令行客户端，输入命令<code>SELECT * FROM Suppliers</code>，然后按Enter键。<br><img src="https://img-blog.csdnimg.cn/2020021120553321.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>&emsp;&emsp;下面的表格是更新后的数据表。这里我截取了本次和上一次的数据表，为的是有一个明显的对比。我们看到，Supplier X和Supplier Y相关的8行记录已经被更新为CSV输入文件中提供的数据。  </p>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2020/02/11/Python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%BA%93(2)/">
                Python数据分析基础之数据库(2)
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2020-02-11</span>
            
            
            
        </div>
    </div>

    
        <div class="content">
            <p>&emsp;&emsp;上一篇博客主要讲了使用Python的内置模块sqlite3来创建内存数据库，这篇博客以及之后的博客主要讲MySQL数据库。  </p>
<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>&emsp;&emsp;我们需要安装Python的MySQLdb扩展包，在Python 2中是MySQL-python，在Python 3中是mysqlclient。我使用的是Anaconda，这个扩展包随着安装Anaconda的时候就捆绑安装好了。<br>&emsp;&emsp;我们还需要安装MySQL。msi版安装教程可以参考我之前写的博客：<a href="https://blog.csdn.net/qq_45554010/article/details/104254892" target="_blank" rel="noopener">《MySQL Community 8.0.19.0 msi版安装教程》</a>，zip版安装教程请自行查阅。  </p>
<h2 id="在MySQL中创建新数据库"><a href="#在MySQL中创建新数据库" class="headerlink" title="在MySQL中创建新数据库"></a>在MySQL中创建新数据库</h2><p>&emsp;&emsp;打开MySQL 8.0 Command Line Client，输入root密码，进入MySQL。<br><img src="https://img-blog.csdnimg.cn/20200211113356992.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>&emsp;&emsp;输入命令<code>SHOW DATABASES;</code>，然后按Enter键，我们可以看到，在MySQL数据库系统中已经有了4个数据库。这些数据库使MySQL数据库系统能够运行，并包含系统用户的权限信息。注意：在输入命令<code>SHOW DATABASES;</code>的时候，<strong>必须要输入分号</strong>。<br><img src="https://img-blog.csdnimg.cn/20200211113838267.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>&emsp;&emsp;接下来我们来创建自己的数据库。输入命令<code>CREATE DATABASE my_suppliers;</code>，然后按Enter键。我们可以再运行一次<code>SHOW DATABASE;</code>命令，这时我们可以看到我们刚刚创建的<code>my_suppliers</code>数据库。<br><img src="https://img-blog.csdnimg.cn/20200211114219439.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>&emsp;&emsp;要使用<code>my_suppliers</code>数据库，必须先选择它。输入命令<code>USE my_suppliers;</code>，然后按Enter键。这样我们就已经选择了<code>my_suppliers</code>数据库。<br><img src="https://img-blog.csdnimg.cn/20200211114436643.png" alt="在这里插入图片描述"></p>
<p>&emsp;&emsp;接下来我们创建一个数据表<code>Suppliers</code>。输入以下命令，然后按Enter键：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE IF NOT EXISTS Suppliers</span><br><span class="line">(Supplier_Name VARCHAR(20),</span><br><span class="line">Invoice_Number VARCHAR(20),</span><br><span class="line">Part_Number VARCHAR(20),</span><br><span class="line">Cost FLOAT,</span><br><span class="line">Purchase_Date DATE);</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20200211114912180.png" alt="在这里插入图片描述"></p>
<p>&emsp;&emsp;我们来解释一下上面的命令。<br>&emsp;&emsp;如果数据库中不存在数据表<code>Suppliers</code>，这个命令就创建数据表<code>Suppliers</code>。这个表有5个列。其中，前3个列是可变字符<code>VARCHAR</code>型字段。<code>20</code>表示为这个字段中的数据分配20个字符。如果输入这个字段的数据大于20个字符，那么数据将被截断。如果数据少于20个字符，那么这个字段就为数据分配一个更小的空间。<br>&emsp;&emsp;第4列是一个浮点数<code>FLOAT</code>字段。浮点数字段保存浮点数近似值。在本例中，第4列包含的是货币值，所以可以用<code>NUMERIC</code>定点确定值类型字段替代<code>FLOAT</code>类型字段。不使用<code>FLOAT</code>，也可以使用<code>NUMERIC(11, 2)</code>。其中<code>11</code>是数值的精度，也就是为数值保存的数位总数（包括小数点后面的位数）。<code>2</code>是小数位数，即小数点后面的数位总数。<br>&emsp;&emsp;第5列是一个日期<code>DATE</code>字段。<code>DATE</code>字段用来保存日期，形式为<code>YYYY-MM-DD</code>，没有时间部分。<br>&emsp;&emsp;为了确保数据表创建正确，输入命令<code>DESCRIBE Suppliers;</code>，然后按Enter键。<br><img src="https://img-blog.csdnimg.cn/20200211120009829.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>&emsp;&emsp;我们看到了一个表格，其中列出了创建的列的名称，每列的数据类型以及列中的值是否可以为<code>NULL</code>。<br>&emsp;&emsp;接下来我们创建一个新用户。输入命令<code>CREATE USER &#39;username&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;secret_password&#39;;</code>（请注意用要使用的用户名替换<code>username</code>，用自己的密码替换<code>secret_password</code>），然后按Enter键。<br>&emsp;&emsp;输入以下两条命令，然后在每条命令后面按Enter键，来向新用户授于所有权限。同样地，用要使用的用户名替换下面的<code>username</code>。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GRANT ALL PRIVILEGES ON my_suppliers.* TO &apos;username&apos;@&apos;localhost&apos;;</span><br><span class="line">FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;这样我们就可以同本地主机中的<code>my_suppliers</code>数据库中的<code>Suppliers</code>表进行交互了。<br><img src="https://img-blog.csdnimg.cn/20200211162149574.png" alt="在这里插入图片描述"></p>
<h2 id="向表中插入新记录"><a href="#向表中插入新记录" class="headerlink" title="向表中插入新记录"></a>向表中插入新记录</h2><p>&emsp;&emsp;下面的Python脚本会将数据从CSV文件中插入到我们的数据表，然后展示表中的数据。我们还是以supplier_data.csv为例。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"></span><br><span class="line">import csv</span><br><span class="line">import MySQLdb</span><br><span class="line">import sys</span><br><span class="line">from datetime import datetime, date</span><br><span class="line"></span><br><span class="line"># CSV输入文件的路径和文件名</span><br><span class="line">input_file = sys.argv[1]</span><br><span class="line"></span><br><span class="line"># 连接MySQL数据库</span><br><span class="line">con = MySQLdb.connect(host=&apos;localhost&apos;, port=3306, db=&apos;my_suppliers&apos;, user=&apos;root&apos;, passwd=&apos;## your password ##&apos;)</span><br><span class="line">c = con.cursor()</span><br><span class="line"></span><br><span class="line"># 向Suppliers表中插入数据</span><br><span class="line">file_reader = csv.reader(open(input_file, &apos;r&apos;, newline=&apos;&apos;))</span><br><span class="line">header = next(file_reader)</span><br><span class="line">for row in file_reader:</span><br><span class="line">    data = []</span><br><span class="line">    for column_index in range(len(header)):</span><br><span class="line">        if column_index &lt; 4:</span><br><span class="line">            data.append(str(row[column_index]).lstrip(&apos;$&apos;).replace(&apos;,&apos;, &apos;&apos;).strip())</span><br><span class="line">        else:</span><br><span class="line">            a_date = datetime.date(datetime.strptime(str(row[column_index]), &apos;%m/%d/%Y&apos;))</span><br><span class="line">            a_date = a_date.strftime(&apos;%Y-%m-%d&apos;)</span><br><span class="line">            data.append(a_date)</span><br><span class="line">    print(data)</span><br><span class="line">    c.execute(&quot;&quot;&quot;INSERT INTO Suppliers VALUES (%s, %s, %s, %s, %s);&quot;&quot;&quot;, data)</span><br><span class="line">con.commit()</span><br><span class="line">print(&quot;&quot;)</span><br><span class="line"></span><br><span class="line"># 查询Suppliers表</span><br><span class="line">c.execute(&quot;SELECT * FROM Suppliers&quot;)</span><br><span class="line">rows = c.fetchall()</span><br><span class="line">for row in rows:</span><br><span class="line">    row_list_output = []</span><br><span class="line">    for column_index in range(len(row)):</span><br><span class="line">        row_list_output.append(str(row[column_index]))</span><br><span class="line">    print(row_list_output)</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;第12行代码使用MySQLdb模块的<code>connect()</code>方法连接<code>my_suppliers</code>，即前面我们创建的MySQL数据库。在连接时，我们需要指定一些通用参数。<code>host</code>是数据库所在的机器的主机名，在这里，MySQL服务器保存在我们的计算机上，所以<code>host</code>是<code>localhost</code>。<code>port</code>是MySQL服务器的TCP/IP连接端口号，这里我们使用的端口号是默认的端口号3306。<code>db</code>是想要连接的数据库名称。<code>user</code>是进行数据库连接的用户的用户名，<code>passwd</code>即为密码。在这里我们作为“root”用户进行连接，使用的密码就是在安装MySQL服务器时创建的密码。我们此前新建了一个新用户，如果想使用新用户，我们只需要把用户名和密码相应地替换掉即可。<br>&emsp;&emsp;我们在命令行窗口中运行这个脚本，得到输出结果。<br><img src="https://img-blog.csdnimg.cn/20200211162509331.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>&emsp;&emsp;这个输出结果证明了数据被成功地加载到了<code>Suppliers</code>表中，并被成功读出。<br>&emsp;&emsp;我们打开MySQL命令行客户端，输入命令<code>SELECT * FROM Suppliers;</code>，可以看到一个表格，其中列出了<code>Suppliers</code>数据表中所有的列以及每列中的12行数据。<br><img src="https://img-blog.csdnimg.cn/20200211162818607.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2020/02/10/MySQL%20Community%208.0.19.0%20msi%E7%89%88%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/">
                MySQL Community 8.0.19.0 msi版安装教程
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2020-02-10</span>
            
            
            
        </div>
    </div>

    
        <div class="content">
            <h3 id="1-在MySQL官网中下载msi文件"><a href="#1-在MySQL官网中下载msi文件" class="headerlink" title="1.在MySQL官网中下载msi文件"></a>1.在MySQL官网中下载msi文件</h3><p>下载地址：<a href="https://dev.mysql.com/downloads/windows/installer/8.0.html" target="_blank" rel="noopener">https://dev.mysql.com/downloads/windows/installer/8.0.html</a><br><img src="https://img-blog.csdnimg.cn/2020021021112714.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">如上图所示，下载第二个即可。<strong>这里需要说明的一点是，虽然这里的MySQL Installer是32位，但会同时安装32位和64位二进制文件。</strong>  </p>
<h3 id="2-打开下载好的msi文件进行安装"><a href="#2-打开下载好的msi文件进行安装" class="headerlink" title="2.打开下载好的msi文件进行安装"></a>2.打开下载好的msi文件进行安装</h3><p>2.1 选择Custom，点击Next。<br><img src="https://img-blog.csdnimg.cn/20200210211604540.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>2.2 将MySQL Server 8.0.19 - X64移动到右侧，如下图所示。点击Next。<br><img src="https://img-blog.csdnimg.cn/20200210211645436.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>2.3 点击Execute。<br><img src="https://img-blog.csdnimg.cn/20200210211747522.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>2.4 短暂等待后，点击Next。<br><img src="https://img-blog.csdnimg.cn/20200210211812888.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>2.5 点击Next。<br><img src="https://img-blog.csdnimg.cn/20200210211854223.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>2.6 点击Next。<br><img src="https://img-blog.csdnimg.cn/20200210211914480.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>2.7 点击Next。<br><img src="https://img-blog.csdnimg.cn/20200210211930403.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>2.8 点击Next。<br><img src="https://img-blog.csdnimg.cn/20200210211953438.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>2.9 设置root密码，<strong>root密码一定要牢记</strong>！！！记性不好的可以把它存在手机的备忘录里哦~设置完成后点击Next。<br><img src="https://img-blog.csdnimg.cn/20200210212028836.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>2.10 点击Next。<br><img src="https://img-blog.csdnimg.cn/20200210212326273.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>2.11 点击Execute。<br><img src="https://img-blog.csdnimg.cn/20200210212424191.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>短暂等待之后，这七个白色的小圆圈都变成绿色了，如下图所示。点击Finish。<br><img src="https://img-blog.csdnimg.cn/20200210212514831.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>2.12 点击Next。<br><img src="https://img-blog.csdnimg.cn/20200210212540832.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>2.13 点击Finish完成安装。<br><img src="https://img-blog.csdnimg.cn/20200210212604571.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h3 id="3-检验是否安装成功"><a href="#3-检验是否安装成功" class="headerlink" title="3.检验是否安装成功"></a>3.检验是否安装成功</h3><p>打开开始菜单，我们会发现MySQL文件夹，如下图所示。<br><img src="https://img-blog.csdnimg.cn/20200210212653834.png" alt="在这里插入图片描述"></p>
<p>打开MySQL 8.0 Command Line Client，输入此前设置的root密码，如下图所示。这样即为安装成功。<br><img src="https://img-blog.csdnimg.cn/20200210212838937.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2020/02/10/Python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%BA%93(1)/">
                Python数据分析基础之数据库(1)
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2020-02-10</span>
            
            
            
        </div>
    </div>

    
        <div class="content">
            <p>&emsp;&emsp;SQL（Structured Query Language），表示结构化查询语言，是一组应用广泛的与数据库交互的命令。要学习如何使用Python同数据库交互，首先我们要有一个数据库，并且数据库中要有一张充满数据的表。有两种资源可供我们选择：一是Python的内置模块sqlite3，它可以创建内存数据库，我们不用下载安装专门的数据库软件；二是MySQL、PostgreSQL或Oracle这样的常用数据库系统。  </p>
<h2 id="使用sqlite3模块创建数据库"><a href="#使用sqlite3模块创建数据库" class="headerlink" title="使用sqlite3模块创建数据库"></a>使用sqlite3模块创建数据库</h2><p>&emsp;&emsp;首先，我们使用sqlite3模块直接在Python代码中创建一个内存数据库以及充满了数据的表。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"></span><br><span class="line">import sqlite3</span><br><span class="line"></span><br><span class="line"># 创建SQLite3内存数据库</span><br><span class="line"># 创建带有4个属性的sales表</span><br><span class="line">con = sqlite3.connect(&apos;:memory:&apos;)</span><br><span class="line">query = &quot;&quot;&quot;CREATE TABLE sales</span><br><span class="line">           (customer VARCHAR(20),</span><br><span class="line">           product VARCHAR(40),</span><br><span class="line">           amount FLOAT,</span><br><span class="line">           date DATE);&quot;&quot;&quot;</span><br><span class="line">con.execute(query)</span><br><span class="line">con.commit()</span><br><span class="line"></span><br><span class="line"># 在表中插入几行数据</span><br><span class="line">data = [(&apos;Richard Lucas&apos;, &apos;Notepad&apos;, 2.50, &apos;2014-01-02&apos;),</span><br><span class="line">        (&apos;Jenny Kim&apos;, &apos;Binder&apos;, 4.15, &apos;2014-01-15&apos;),</span><br><span class="line">        (&apos;Svetlana Crow&apos;, &apos;Printer&apos;, 155.75, &apos;2014-02-03&apos;),</span><br><span class="line">        (&apos;Stephen Randolph&apos;, &apos;Computer&apos;, 679.40, &apos;2014-02-20&apos;)]</span><br><span class="line">statement = &quot;INSERT INTO sales VALUES(?, ?, ?, ?)&quot;</span><br><span class="line">con.executemany(statement, data)</span><br><span class="line">con.commit()</span><br><span class="line"></span><br><span class="line"># 查询sales表</span><br><span class="line">cursor = con.execute(&quot;SELECT * FROM sales&quot;)</span><br><span class="line">rows = cursor.fetchall()</span><br><span class="line"></span><br><span class="line"># 计算查询结果中行的数量</span><br><span class="line">row_counter = 0</span><br><span class="line">for row in rows:</span><br><span class="line">    print(row)</span><br><span class="line">    row_counter += 1</span><br><span class="line">print(&apos;Number of rows: %d&apos; % (row_counter))</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;第3行代码导入了sqlite3模块。为了使用这个模块，首先必须创建一个代表数据库的连接对象。第7行代码创建了连接对象<code>con</code>来代表数据库。专用名称<code>&#39;:memory:&#39;</code>在内存中创建了一个数据库。如果想要数据库持久化，就需要提供另外的字符串。<br>&emsp;&emsp;第8-12行代码使用三重双引号创建了一个多行字符串，并将这个字符串赋给变量<code>query</code>。这个字符串是一个SQL命令，可以在数据库中创建一个名为<code>sales</code>的表。<code>sales</code>表有4个属性：<code>customer</code>, <code>product</code>, <code>amount</code>和<code>date</code>。<code>customer</code>和<code>product</code>都是变长字符型字段，最大字符数分别为20和40。<code>amount</code>是一个浮点数型字段。<code>date</code>是一个日期型字段。<br>&emsp;&emsp;第13行代码使用连接对象的<code>execute()</code>方法执行包含在变量<code>query</code>中的SQL命令，在内存数据库中创建<code>sales</code>表。第14行代码使用连接对象的<code>commit()</code>方法将修改提交（也就是保存）到数据库。对数据库做出修改时必须使用<code>commit()</code>方法保存修改。<br>&emsp;&emsp;第21行代码与第8行代码类似，创建了一个字符串并赋给变量<code>statement</code>。这行代码中的字符串是另一个SQL命令，<code>INSERT</code>语句可以将<code>data</code>中的数据行插入<code>sales</code>表。<code>?</code>在这里用作占位符，表示想在SQL命令中使用的值。然后，在连接对象的<code>execute()</code>或<code>executemany()</code>方法中，需要提供一个包含4个值的元组，元组中的值会按位置替换到SQL命令中。<br>&emsp;&emsp;第26行代码使用连接对象的<code>execute()</code>方法运行一条SQL命令，并将命令结果赋给一个光标变量<code>cursor</code>。第27行代码执行了<code>fetchall()</code>方法，返回第26行代码中的SQL命令的数据行的列表。每行数据都是一个元组，所以<code>rows</code>是一个元组列表。在这种情况下，<code>sales</code>表中包含4行数据，SQL命令从<code>sales</code>表中选择所有的行，所以<code>rows</code>是一个含有4个元组的列表。<br>&emsp;&emsp;运行结果如下：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(&apos;Richard Lucas&apos;, &apos;Notepad&apos;, 2.5, &apos;2014-01-02&apos;)</span><br><span class="line">(&apos;Jenny Kim&apos;, &apos;Binder&apos;, 4.15, &apos;2014-01-15&apos;)</span><br><span class="line">(&apos;Svetlana Crow&apos;, &apos;Printer&apos;, 155.75, &apos;2014-02-03&apos;)</span><br><span class="line">(&apos;Stephen Randolph&apos;, &apos;Computer&apos;, 679.4, &apos;2014-02-20&apos;)</span><br><span class="line">Number of rows: 4</span><br></pre></td></tr></table></figure>
<h2 id="向表中插入新记录"><a href="#向表中插入新记录" class="headerlink" title="向表中插入新记录"></a>向表中插入新记录</h2><p>&emsp;&emsp;下面的这个脚本将创建一个数据表，向表中插入CSV文件中的数据，然后展示表中的数据。这里使用的CSV文件是前面用到过的supplier_data.csv文件。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"></span><br><span class="line">import csv</span><br><span class="line">import sqlite3</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line"># CSV输入文件的路径和文件名</span><br><span class="line">input_file = sys.argv[1]</span><br><span class="line"></span><br><span class="line"># 创建SQLite3内存数据库</span><br><span class="line"># 创建带有5个属性的Suppliers表</span><br><span class="line">con = sqlite3.connect(&apos;E:\\python_pycharm\\Python数据分析基础\\第4章 数据库\\Suppliers.db&apos;)</span><br><span class="line">c = con.cursor()</span><br><span class="line">create_table = &quot;&quot;&quot;CREATE TABLE IF NOT EXISTS Suppliers</span><br><span class="line">                  (Supplier_Name VARCHAR(20),</span><br><span class="line">                  Invoice_Number VARCHAR(20),</span><br><span class="line">                  Part_Number VARCHAR(20),</span><br><span class="line">                  Cost FLOAT,</span><br><span class="line">                  Purchase_Date DATE);&quot;&quot;&quot;</span><br><span class="line">c.execute(create_table)</span><br><span class="line">con.commit()</span><br><span class="line"></span><br><span class="line"># 读取CSV文件</span><br><span class="line"># 向Suppliers表中插入数据</span><br><span class="line">file_reader = csv.reader(open(input_file, &apos;r&apos;), delimiter=&apos;,&apos;)</span><br><span class="line">header = next(file_reader, None)</span><br><span class="line">for row in file_reader:</span><br><span class="line">    data = []</span><br><span class="line">    for column_index in range(len(header)):</span><br><span class="line">        data.append(row[column_index])</span><br><span class="line">    print(data)</span><br><span class="line">    c.execute(&quot;INSERT INTO Suppliers VALUES (?, ?, ?, ?, ?);&quot;, data)</span><br><span class="line">con.commit()</span><br><span class="line">print(&apos;&apos;)</span><br><span class="line"></span><br><span class="line"># 查询Suppliers表</span><br><span class="line">output = c.execute(&quot;SELECT * FROM Suppliers&quot;)</span><br><span class="line">rows = output.fetchall()</span><br><span class="line">for row in rows:</span><br><span class="line">    output = []</span><br><span class="line">    for column_index in range(len(row)):</span><br><span class="line">        output.append(str(row[column_index]))</span><br><span class="line">    print(output)</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;第12行代码为本地数据库<code>Suppliers.db</code>创建连接。这是一个持久化数据库，即使重启计算机，这个数据库也不会被删除。<br>&emsp;&emsp;第25-33行代码从CSV输入文件中读取要加载到数据库中的数据，并对输入文件中的每行数据执行一条SQL语句，将数据插入到数据库的表中。第32行代码将每行数据加载到数据表中。第33行代码使用<code>commit()</code>方法将修改提交到数据库。<br>&emsp;&emsp;第37-43行代码从数据表<code>Suppliers</code>中选择所有数据，并将输出打印到命令行窗口。第37-38行代码执行一条SQL语句，从<code>Suppliers</code>表中选择所有数据，并将<code>output</code>中的所有行读入变量<code>rows</code>。<br>&emsp;&emsp;在命令行窗口中运行这个脚本，得到输出结果如下：<br><img src="https://img-blog.csdnimg.cn/2020021019311438.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>&emsp;&emsp;输出的第一部分是从CSV文件中解析出的数据行，输出的第二部分是同样的行，但它是从sqlite数据表中提取出来的。  </p>
<h2 id="更新表中记录"><a href="#更新表中记录" class="headerlink" title="更新表中记录"></a>更新表中记录</h2><p>&emsp;&emsp;我们可以使用CSV输入文件向数据表中添加新行，也可以使用从CSV输入文件中读取数据的技术来更新表中已有的行。在这种情况下，SQL语句有所改变，从<code>INSERT</code>语句变成了<code>UPDATE</code>语句。代码如下：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"></span><br><span class="line">import csv</span><br><span class="line">import sqlite3</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line"># CSV输入文件的路径和文件名</span><br><span class="line">input_file = sys.argv[1]</span><br><span class="line"></span><br><span class="line"># 创建SQLite3内存数据库</span><br><span class="line"># 创建带有4个属性的sales表</span><br><span class="line">con = sqlite3.connect(&apos;:memory:&apos;)</span><br><span class="line">query = &quot;&quot;&quot;CREATE TABLE IF NOT EXISTS sales</span><br><span class="line">           (customer VARCHAR(20),</span><br><span class="line">           product VARCHAR(40),</span><br><span class="line">           amount FLOAT,</span><br><span class="line">           date DATE);&quot;&quot;&quot;</span><br><span class="line">con.execute(query)</span><br><span class="line">con.commit()</span><br><span class="line"></span><br><span class="line"># 向表中插入几行数据</span><br><span class="line">data = [(&apos;Richard Lucas&apos;, &apos;Notepad&apos;, 2.50, &apos;2014-01-02&apos;),</span><br><span class="line">        (&apos;Jenny Kim&apos;, &apos;Binder&apos;, 4.15, &apos;2014-01-15&apos;),</span><br><span class="line">        (&apos;Svetlana Crow&apos;, &apos;Printer&apos;, 155.75, &apos;2014-02-03&apos;),</span><br><span class="line">        (&apos;Stephen Randolph&apos;, &apos;Computer&apos;, 679.40, &apos;2014-02-20&apos;)]</span><br><span class="line">for tuple in data:</span><br><span class="line">    print(tuple)</span><br><span class="line">statement = &quot;INSERT INTO sales VALUES(?, ?, ?, ?)&quot;</span><br><span class="line">con.executemany(statement, data)</span><br><span class="line">con.commit()</span><br><span class="line"></span><br><span class="line"># 读取CSV文件并更新特定的行</span><br><span class="line">file_reader = csv.reader(open(input_file, &apos;r&apos;), delimiter=&apos;,&apos;)</span><br><span class="line">header = next(file_reader, None)</span><br><span class="line">for row in file_reader:</span><br><span class="line">    data = []</span><br><span class="line">    for column_index in range(len(header)):</span><br><span class="line">        data.append(row[column_index])</span><br><span class="line">    print(data)</span><br><span class="line">    con.execute(&quot;UPDATE sales SET amount=?, date=? WHERE customer=?;&quot;, data)</span><br><span class="line">con.commit()</span><br><span class="line"></span><br><span class="line"># 查询sales表</span><br><span class="line">cursor = con.execute(&quot;SELECT * FROM sales&quot;)</span><br><span class="line">rows = cursor.fetchall()</span><br><span class="line">for row in rows:</span><br><span class="line">    output = []</span><br><span class="line">    for column_index in range(len(row)):</span><br><span class="line">        output.append(str(row[column_index]))</span><br><span class="line">    print(output)</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;第40行代码，<code>UPDATE</code>语句代替了原来的<code>INSERT</code>语句。在<code>UPDATE</code>语句中，我们必须指定想更新哪一条记录和哪一个列属性。在这里，我们想为一组特定的<code>customer</code>更新<code>amount</code>值和<code>date</code>值。像前面的示例一样，<code>UPDATE</code>语句也需要占位符表示查询中的值的位置，CSV输入文件中数据的顺序也要同查询中属性的顺序一样。<br>&emsp;&emsp;我们新建一个CSV输入文件：<br><img src="https://img-blog.csdnimg.cn/20200210202106745.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>&emsp;&emsp;在命令行窗口中运行这个脚本，得到下面的输出结果。<br><img src="https://img-blog.csdnimg.cn/20200210202147190.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>&emsp;&emsp;这个输出首先展示了数据库中初始的4行数据，接下来2行是要更新到数据库中的2行数据。在这2行下面，输出还展示了执行更新之后从数据表中取出的4行数据。  </p>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2020/02/10/Python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80%E4%B9%8BExcel%E6%96%87%E4%BB%B6(6)/">
                Python数据分析基础之Excel文件(6)
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2020-02-10</span>
            
            
            
        </div>
    </div>

    
        <div class="content">
            <p>&emsp;&emsp;这一篇博客主要讲一下处理多个工作簿。<br>&emsp;&emsp;之前我们已经创建了sales_2013.xlsx工作簿。在这里，我们再创建两个新的工作簿sales_2014.xlsx和sales_2015.xlsx，并且修改其中的工作表名称和日期数据。<br><img src="https://img-blog.csdnimg.cn/20200210084609347.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">)<img src="https://img-blog.csdnimg.cn/20200210084620268.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">)<img src="https://img-blog.csdnimg.cn/20200210084629291.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">)<img src="https://img-blog.csdnimg.cn/20200210084650308.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">)<img src="https://img-blog.csdnimg.cn/2020021008473444.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">)<img src="https://img-blog.csdnimg.cn/2020021008481770.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h2 id="工作表计数以及每个工作表中的行列计数"><a href="#工作表计数以及每个工作表中的行列计数" class="headerlink" title="工作表计数以及每个工作表中的行列计数"></a>工作表计数以及每个工作表中的行列计数</h2><p>&emsp;&emsp;如果想知道一个文件夹中工作簿的数量，每个工作簿中工作表的数量，以及每个工作表中的行与列的数量，我们可以编写下面的代码：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"></span><br><span class="line">import glob</span><br><span class="line">import os</span><br><span class="line">import sys</span><br><span class="line">from xlrd import open_workbook</span><br><span class="line"></span><br><span class="line">input_directory = sys.argv[1]</span><br><span class="line"></span><br><span class="line">workbook_counter = 0</span><br><span class="line">for input_file in glob.glob(os.path.join(input_directory, &apos;*.xlsx&apos;)):</span><br><span class="line">    workbook = open_workbook(input_file)</span><br><span class="line">    print(&apos;Workbook: %s&apos; % os.path.basename(input_file))</span><br><span class="line">    print(&apos;Number of worksheets: %d&apos; % workbook.nsheets)</span><br><span class="line">    for worksheet in workbook.sheets():</span><br><span class="line">        print(&apos;Worksheet name: &apos;, worksheet.name, &apos;\tRows: &apos;, worksheet.nrows, &apos;\tColumns: &apos;, worksheet.ncols)</span><br><span class="line">    workbook_counter += 1</span><br><span class="line">print(&apos;Number of Excel workbooks: %d&apos; % (workbook_counter))</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;这和之前的内省单个工作簿的代码非常相似。我们在命令行窗口中运行这个脚本，得到下面的输出结果。<br><img src="https://img-blog.csdnimg.cn/20200210085206136.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h2 id="从多个工作簿中连接数据"><a href="#从多个工作簿中连接数据" class="headerlink" title="从多个工作簿中连接数据"></a>从多个工作簿中连接数据</h2><p>&emsp;&emsp;使用Python可以将多个工作簿中所有工作表的数据垂直连接成一个输出文件。  </p>
<h4 id="1-基础Python"><a href="#1-基础Python" class="headerlink" title="1.基础Python"></a>1.基础Python</h4><p>&emsp;&emsp;代码如下：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"></span><br><span class="line">import glob</span><br><span class="line">import os</span><br><span class="line">import sys</span><br><span class="line">from datetime import date</span><br><span class="line">from xlrd import open_workbook, xldate_as_tuple</span><br><span class="line">from xlwt import Workbook</span><br><span class="line"></span><br><span class="line">input_folder = sys.argv[1]</span><br><span class="line">output_file = sys.argv[2]</span><br><span class="line"></span><br><span class="line">output_workbook = Workbook()</span><br><span class="line">output_worksheet = output_workbook.add_sheet(&apos;all_data_all_workbooks&apos;, cell_overwrite_ok=True)</span><br><span class="line">data = []</span><br><span class="line">first_worksheet = True</span><br><span class="line">for input_file in glob.glob(os.path.join(input_folder, &apos;*.xlsx&apos;)):</span><br><span class="line">    print(os.path.basename(input_file))</span><br><span class="line">    with open_workbook(input_file) as workbook:</span><br><span class="line">        for worksheet in workbook.sheets():</span><br><span class="line">            if first_worksheet:</span><br><span class="line">                header_row = worksheet.row_values(0)</span><br><span class="line">                data.append(header_row)</span><br><span class="line">                first_worksheet = False</span><br><span class="line">            for row_index in range(1, worksheet.nrows):</span><br><span class="line">                row_list = []</span><br><span class="line">                for column_index in range(worksheet.ncols):</span><br><span class="line">                    cell_value = worksheet.cell_value(row_index, column_index)</span><br><span class="line">                    cell_type = worksheet.cell_type(row_index, column_index)</span><br><span class="line">                    if cell_type == 3:</span><br><span class="line">                        date_cell = xldate_as_tuple(cell_value, workbook.datemode)</span><br><span class="line">                        date_cell = date(*date_cell[0:3]).strftime(&apos;%m/%d/%Y&apos;)</span><br><span class="line">                        row_list.append(date_cell)</span><br><span class="line">                    else:</span><br><span class="line">                        row_list.append(cell_value)</span><br><span class="line">                data.append(row_list)</span><br><span class="line">    for list_index, output_list in enumerate(data):</span><br><span class="line">        for element_index, element in enumerate(output_list):</span><br><span class="line">            output_worksheet.write(list_index, element_index, element)</span><br><span class="line">output_workbook.save(output_file)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>作者注：在第14行代码中，参考书上的代码并没有’cell_overwrite_ok=True’这一参数，这是我在写代码的时候报错后自己加上去的。<br>报错信息如下：<br>Traceback (most recent call last):<br>  File “E:\python_pycharm\Python数据分析基础\第3章 Excel文件\13excel_concat_data_from_multiple_workbook.py”, line 39, in <module><br>    output_worksheet.write(list_index, element_index, element)<br>  File “D:\Anaconda3\lib\site-packages\xlwt\Worksheet.py”, line 1088, in write<br>    self.row(r).write(c, label, style)<br>  File “D:\Anaconda3\lib\site-packages\xlwt\Row.py”, line 235, in write<br>    StrCell(self.<strong>idx, col, style_index, self.</strong>parent_wb.add_str(label))<br>  File “D:\Anaconda3\lib\site-packages\xlwt\Row.py”, line 154, in insert_cell<br>    raise Exception(msg)<br>Exception: Attempt to overwrite cell: sheetname=’all_data_all_workbooks’ rowx=0 colx=0<br>查阅有关资料后得知，对一个单元格重复操作会引发ReturnsError，这个时候只要在打开文件的时候加上’cell_overwrite_ok=True’即可解决。这应该是书本上的错误。  </p>
</blockquote>
<p>&emsp;&emsp;在命令行窗口中运行这个代码，得到输出文件。<br><img src="https://img-blog.csdnimg.cn/20200210093005610.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">)<img src="https://img-blog.csdnimg.cn/20200210093047339.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h4 id="2-pandas"><a href="#2-pandas" class="headerlink" title="2.pandas"></a>2.pandas</h4><p>&emsp;&emsp;pandas模块提供了<code>concat()</code>函数来连接数据框。如果想把数据框一个一个地垂直堆叠起来，需要设置参数<code>axis=0</code>；如果想把数据框一个一个地平行连接起来，需要设置参数<code>axis=1</code>。如果我们需要基于某个关键字列连接数据框，可以使用pandas模块的<code>merge()</code>函数。<br>&emsp;&emsp;使用pandas模块的代码如下：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"></span><br><span class="line">import pandas as pd</span><br><span class="line">import glob</span><br><span class="line">import os</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">input_path = sys.argv[1]</span><br><span class="line">output_file = sys.argv[2]</span><br><span class="line"></span><br><span class="line">all_workbooks = glob.glob(os.path.join(input_path, &apos;*.xlsx&apos;))</span><br><span class="line">data_frames = []</span><br><span class="line">for workbook in all_workbooks:</span><br><span class="line">    all_worksheets = pd.read_excel(workbook, sheet_name=None, index_col=None)</span><br><span class="line">    for worksheet_name, data in all_worksheets.items():</span><br><span class="line">        data_frames.append(data)</span><br><span class="line">all_data_concatenated = pd.concat(data_frames, axis=0, ignore_index=True)</span><br><span class="line">writer = pd.ExcelWriter(output_file)</span><br><span class="line">all_data_concatenated.to_excel(writer, sheet_name=&apos;all_data_all_workbooks&apos;, index=False)</span><br><span class="line">writer.save()</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;在命令行窗口中运行这个脚本，得到输出文件。<br><img src="https://img-blog.csdnimg.cn/20200210093549770.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h2 id="为每个工作簿和工作表计算总数和均值"><a href="#为每个工作簿和工作表计算总数和均值" class="headerlink" title="为每个工作簿和工作表计算总数和均值"></a>为每个工作簿和工作表计算总数和均值</h2><h4 id="基础Python"><a href="#基础Python" class="headerlink" title="基础Python"></a>基础Python</h4><p>&emsp;&emsp;代码如下：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"></span><br><span class="line">import glob</span><br><span class="line">import os</span><br><span class="line">import sys</span><br><span class="line">from datetime import date</span><br><span class="line">from xlrd import open_workbook, xldate_as_tuple</span><br><span class="line">from xlwt import Workbook</span><br><span class="line"></span><br><span class="line">input_folder = sys.argv[1]</span><br><span class="line">output_file = sys.argv[2]</span><br><span class="line"></span><br><span class="line">output_workbook = Workbook()</span><br><span class="line">output_worksheet = output_workbook.add_sheet(&apos;sums_and_averages&apos;)</span><br><span class="line">all_data = []</span><br><span class="line">sales_column_index = 3</span><br><span class="line">header = [&apos;workbook&apos;, &apos;worksheet&apos;, &apos;worksheet_total&apos;, &apos;worksheet_average&apos;, &apos;workbook_total&apos;, &apos;workbook_average&apos;]</span><br><span class="line">all_data.append(header)</span><br><span class="line">for input_file in glob.glob(os.path.join(input_folder, &apos;*.xlsx&apos;)):</span><br><span class="line">    with open_workbook(input_file) as workbook:</span><br><span class="line">        list_of_totals = []</span><br><span class="line">        list_of_numbers = []</span><br><span class="line">        workbook_output = []</span><br><span class="line">        for worksheet in workbook.sheets():</span><br><span class="line">            total_sales = 0</span><br><span class="line">            number_of_sales = 0</span><br><span class="line">            worksheet_list = []</span><br><span class="line">            worksheet_list.append(os.path.basename(input_file))</span><br><span class="line">            worksheet_list.append(worksheet.name)</span><br><span class="line">            for row_index in range(1, worksheet.nrows):</span><br><span class="line">                try:</span><br><span class="line">                    total_sales += float(str(worksheet.cell_value(row_index, sales_column_index))</span><br><span class="line">                                         .strip(&apos;$&apos;).replace(&apos;,&apos;, &apos;&apos;))</span><br><span class="line">                    number_of_sales += 1</span><br><span class="line">                except:</span><br><span class="line">                    total_sales += 0</span><br><span class="line">                    number_of_sales += 0</span><br><span class="line">            average_sales = &apos;%.2f&apos; % (total_sales / number_of_sales)</span><br><span class="line">            worksheet_list.append(total_sales)</span><br><span class="line">            worksheet_list.append(float(average_sales))</span><br><span class="line">            list_of_totals.append(total_sales)</span><br><span class="line">            list_of_numbers.append(float(number_of_sales))</span><br><span class="line">            workbook_output.append(worksheet_list)</span><br><span class="line">        workbook_total = sum(list_of_totals)</span><br><span class="line">        workbook_average = sum(list_of_totals) / sum(list_of_numbers)</span><br><span class="line">        for list_element in workbook_output:</span><br><span class="line">            list_element.append(workbook_total)</span><br><span class="line">            list_element.append(workbook_average)</span><br><span class="line">        all_data.extend(workbook_output)</span><br><span class="line"></span><br><span class="line">for list_index, output_list in enumerate(all_data):</span><br><span class="line">    for element_index, element in enumerate(output_list):</span><br><span class="line">        output_worksheet.write(list_index, element_index, element)</span><br><span class="line">output_workbook.save(output_file)</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;第21-23行分别创建了3个空列表，<code>list_of_totals</code>用来保存工作簿中所有工作表的销售额总计，<code>list_of_numbers</code>用来保存工作簿的所有工作表中用来计算总销售额的销售额数据个数，<code>workbook_output</code>用来保存要写入输出文件的所有输出列表。<br>&emsp;&emsp;第27行代码创建了列表<code>worksheet_list</code>，用来保存要保留的所有工作表的信息。<br>&emsp;&emsp;第28-29行代码将工作簿名称和工作表名称追加到<code>worksheet_list</code>中。同样地，第39-40行代码将销售额总计和均值追加到<code>worksheet_list</code>中，第43行代码将<code>worksheet_list</code>追加到<code>workbook_output</code>中，在工作簿级别保存信息。<br>&emsp;&emsp;第41-42行代码将工作表的销售额总计和销售额数据个数分别追加到<code>list_of_totals</code>和<code>list_of_numbers</code>中，这样我们可以对所有工作表保存这些值。<br>&emsp;&emsp;当获得了所有要为工作簿保留的信息之后，就将这些列表扩展到<code>all_data</code>中。这里使用<code>extend()</code>而不是<code>append()</code>，以使<code>workbook_output</code>中的每个列表都会成为<code>all_data</code>中的一个独立元素。在处理完所有工作簿之后，<code>all_data</code>是一个具有9个元素的列表，每个元素都是一个列表。否则，如果使用<code>append()</code>，<code>all_data</code>中就会只有3个元素，每个元素都是一个列表的列表。<br>&emsp;&emsp;在命令行窗口中运行这个脚本，得到输出文件。<br><img src="https://img-blog.csdnimg.cn/20200210144814305.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2020/02/09/Python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80%E4%B9%8BExcel%E6%96%87%E4%BB%B6(5)/">
                Python数据分析基础之Excel文件(5)
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2020-02-09</span>
            
            
            
        </div>
    </div>

    
        <div class="content">
            <p>&emsp;&emsp;上一篇博客主要讲了如何在一个工作簿的所有工作表中筛选特定的行和列。但是，有些情况下，我们只需要处理工作簿中其中几个工作表。在这种情况下，我们可以使用<code>sheet_by_index()</code>或<code>sheet_by_name()</code>函数来处理这些待处理的工作表。  </p>
<h2 id="在一组工作表中筛选特定行"><a href="#在一组工作表中筛选特定行" class="headerlink" title="在一组工作表中筛选特定行"></a>在一组工作表中筛选特定行</h2><h4 id="1-基础Python"><a href="#1-基础Python" class="headerlink" title="1.基础Python"></a>1.基础Python</h4><p>&emsp;&emsp;我们想要筛选出sales_2013.xlsx这个工作簿的第一个和第二个工作表中销售额大于$1900.00的那些行。代码如下：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"></span><br><span class="line">import sys</span><br><span class="line">from datetime import date</span><br><span class="line">from xlrd import open_workbook, xldate_as_tuple</span><br><span class="line">from xlwt import Workbook</span><br><span class="line"></span><br><span class="line">input_file = sys.argv[1]</span><br><span class="line">output_file = sys.argv[2]</span><br><span class="line"></span><br><span class="line">output_workbook = Workbook()</span><br><span class="line">output_worksheet = output_workbook.add_sheet(&apos;set_of_worksheets&apos;)</span><br><span class="line">my_sheets = [0, 1]</span><br><span class="line">threshold = 1900.0</span><br><span class="line">sales_column_index = 3</span><br><span class="line">first_worksheet = True</span><br><span class="line">with open_workbook(input_file) as workbook:</span><br><span class="line">    data = []</span><br><span class="line">    for sheet_index in range(workbook.nsheets):</span><br><span class="line">        if sheet_index in my_sheets:</span><br><span class="line">            worksheet = workbook.sheet_by_index(sheet_index)</span><br><span class="line">            if first_worksheet:</span><br><span class="line">                header_row = worksheet.row_values(0)</span><br><span class="line">                data.append(header_row)</span><br><span class="line">                first_worksheet = False</span><br><span class="line">            for row_index in range(1, worksheet.nrows):</span><br><span class="line">                row_list = []</span><br><span class="line">                sale_amount = worksheet.cell_value(row_index, sales_column_index)</span><br><span class="line">                sale_amount = sale_amount.replace(r&apos;$&apos;, &apos;&apos;)</span><br><span class="line">                sale_amount = sale_amount.replace(r&apos;,&apos;, &apos;&apos;)</span><br><span class="line">                sale_amount = float(sale_amount)</span><br><span class="line">                if sale_amount &gt; threshold:</span><br><span class="line">                    for column_index in range(worksheet.ncols):</span><br><span class="line">                        cell_value = worksheet.cell_value(row_index, column_index)</span><br><span class="line">                        cell_type = worksheet.cell_type(row_index, column_index)</span><br><span class="line">                        if cell_type == 3:</span><br><span class="line">                            date_cell = xldate_as_tuple(cell_value, workbook.datemode)</span><br><span class="line">                            date_cell = date(*date_cell[0:3]).strftime(&apos;%m/%d/%Y&apos;)</span><br><span class="line">                            row_list.append(date_cell)</span><br><span class="line">                        else:</span><br><span class="line">                            row_list.append(cell_value)</span><br><span class="line">                if row_list:</span><br><span class="line">                    data.append(row_list)</span><br><span class="line">    for list_index, output_list in enumerate(data):</span><br><span class="line">        for element_index, element in enumerate(output_list):</span><br><span class="line">            output_worksheet.write(list_index, element_index, element)</span><br><span class="line">output_workbook.save(output_file)</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;第13行创建的列表变量<code>my_sheets</code>包含了两个整数，分别对应要处理的工作表（即第一个和第二个工作表）的索引值。第19行代码创建了工作簿中所有工作表的索引值，第20行代码在<code>for</code>循环中应用<code>if</code>判断语句检验要处理的工作表索引值是否在列表<code>my_sheets</code>中，这样可以确保代码只处理了我们想处理的工作表。  </p>
<blockquote>
<p>作者注：代码的第29-31行是我自己加上的，参考书（《Python数据分析基础》，作者Clinton W. Brownley，译者陈光欣，人民邮电出版社）上的代码并没有这三行，运行的时候会报错：<br>Traceback (most recent call last):<br>  File “E:\python_pycharm\Python数据分析基础\第3章 Excel文件\11excel_value_meets_condition_set_of_worksheets.py”, line 29, in <module><br>    if sale_amount &gt; threshold:<br>TypeError: ‘&gt;’ not supported between instances of ‘str’ and ‘float’<br>改正后可以正常运行。这应该是书本的错误。  </p>
</blockquote>
<p>&emsp;&emsp;在命令行窗口中运行这个脚本，得到输出文件。  </p>
<p><img src="https://img-blog.csdnimg.cn/20200209204544276.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h4 id="2-pandas"><a href="#2-pandas" class="headerlink" title="2.pandas"></a>2.pandas</h4><p>&emsp;&emsp;使用pandas模块在工作簿中选择几个工作表非常容易，我们只需要在<code>read_excel()</code>函数中将工作表的索引值或名称设置成一个列表就可以了。代码如下：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"></span><br><span class="line">import pandas as pd</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">input_file = sys.argv[1]</span><br><span class="line">output_file = sys.argv[2]</span><br><span class="line"></span><br><span class="line">my_sheets = [0, 1]</span><br><span class="line">threshold = 1900.0</span><br><span class="line">data_frame = pd.read_excel(input_file, sheet_name=my_sheets, index_col=None)</span><br><span class="line">row_list = []</span><br><span class="line">for worksheet_name, data in data_frame.items():</span><br><span class="line">    data[&apos;Sale Amount&apos;] = data[&apos;Sale Amount&apos;].str.replace(r&apos;\$&apos;, &apos;&apos;)</span><br><span class="line">    data[&apos;Sale Amount&apos;] = data[&apos;Sale Amount&apos;].str.replace(&apos;,&apos;, &apos;&apos;)</span><br><span class="line">    row_list.append(data[data[&apos;Sale Amount&apos;].astype(float) &gt; threshold])</span><br><span class="line">filtered_rows = pd.concat(row_list, axis=0, ignore_index=True)</span><br><span class="line">writer = pd.ExcelWriter(output_file)</span><br><span class="line">filtered_rows.to_excel(writer, sheet_name=&apos;set_of_worksheets&apos;, index=False)</span><br><span class="line">writer.save()</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;在命令行窗口中运行这个脚本，得到输出文件。<br><img src="https://img-blog.csdnimg.cn/20200209212418387.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2020/02/07/Python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80%E4%B9%8BExcel%E6%96%87%E4%BB%B6(4)/">
                Python数据分析基础之Excel文件(4)
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2020-02-07</span>
            
            
            
        </div>
    </div>

    
        <div class="content">
            <p>&emsp;&emsp;之前的3篇博客主要讲了如何处理单个工作表。但是，很多情况下我们需要处理多个工作表，如果手工处理的话，效率会非常低，甚至根本不可行。在这种情况下，Python可以让我们自动化和规模化地进行数据处理，远远超过手工处理能够达到的限度。  </p>
<h2 id="在所有工作表中筛选特定行"><a href="#在所有工作表中筛选特定行" class="headerlink" title="在所有工作表中筛选特定行"></a>在所有工作表中筛选特定行</h2><h4 id="1-基础Python"><a href="#1-基础Python" class="headerlink" title="1.基础Python"></a>1.基础Python</h4><p>&emsp;&emsp;对于<a href="https://blog.csdn.net/qq_45554010/article/details/104102682" target="_blank" rel="noopener">《Python数据分析基础之Excel文件(1)》</a>中建立的sales_2013.xlsx这个Excel工作簿，我们想在所有工作表中筛选出销售额大于$2,000.00的所有行。代码如下：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"></span><br><span class="line">import sys</span><br><span class="line">from datetime import date</span><br><span class="line">from xlrd import open_workbook, xldate_as_tuple</span><br><span class="line">from xlwt import Workbook</span><br><span class="line"></span><br><span class="line">input_file = sys.argv[1]</span><br><span class="line">output_file = sys.argv[2]</span><br><span class="line"></span><br><span class="line">output_workbook = Workbook()</span><br><span class="line">output_worksheet = output_workbook.add_sheet(&apos;filtered_rows_all_worksheets&apos;)</span><br><span class="line">sales_column_index = 3</span><br><span class="line">threshold = 2000.0</span><br><span class="line">first_worksheet = True</span><br><span class="line">with open_workbook(input_file) as workbook:</span><br><span class="line">    data = []</span><br><span class="line">    for worksheet in workbook.sheets():</span><br><span class="line">        if first_worksheet:</span><br><span class="line">            header_row = worksheet.row_values(0)</span><br><span class="line">            data.append(header_row)</span><br><span class="line">            first_worksheet = False</span><br><span class="line">        for row_index in range(1, worksheet.nrows):</span><br><span class="line">            row_list = []</span><br><span class="line">            sale_amount = worksheet.cell_value(row_index, sales_column_index)</span><br><span class="line">            sale_amount = sale_amount.replace(r&apos;$&apos;, &apos;&apos;)</span><br><span class="line">            sale_amount = sale_amount.replace(r&apos;,&apos;, &apos;&apos;)</span><br><span class="line">            sale_amount = float(sale_amount)</span><br><span class="line">            if sale_amount &gt; threshold:</span><br><span class="line">                for column_index in range(worksheet.ncols):</span><br><span class="line">                    cell_value = worksheet.cell_value(row_index, column_index)</span><br><span class="line">                    cell_type = worksheet.cell_type(row_index, column_index)</span><br><span class="line">                    if cell_type == 3:</span><br><span class="line">                        date_cell = xldate_as_tuple(cell_value, workbook.datemode)</span><br><span class="line">                        date_cell = date(*date_cell[0:3]).strftime(&apos;%m/%d/%Y&apos;)</span><br><span class="line">                        row_list.append(date_cell)</span><br><span class="line">                    else:</span><br><span class="line">                        row_list.append(cell_value)</span><br><span class="line">            if row_list:</span><br><span class="line">                data.append(row_list)</span><br><span class="line">    for list_index, output_list in enumerate(data):</span><br><span class="line">        for element_index, element in enumerate(output_list):</span><br><span class="line">            output_worksheet.write(list_index, element_index, element)</span><br><span class="line">output_workbook.save(output_file)</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;在上面的代码中，变量<code>sales_column_index</code>保存Sale Amount列的索引值，变量<code>threshold</code>保存我们关心的销售额。我们要做的是将Sale Amount列中的每个值与这个阈值进行比较，以此来确定哪一行要被写入输出文件中。变量<code>first_worksheet</code>则是一个旗帜，其作用是用来判断当前工作表是否为第一个工作表。初始化旗帜时，我们将其设为<code>True</code>。<br>&emsp;&emsp;第19行代码通过旗帜来判断当前工作表是否为第一个工作表，如果是第一个工作表，我们就将标题行提取出来，追加到列表<code>data</code>中，然后令<code>first_worksheet = False</code>，继续处理余下的行。<br>&emsp;&emsp;在命令行窗口中运行这个脚本，并打开输出文件查看结果。<br><img src="https://img-blog.csdnimg.cn/20200207211607150.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h4 id="2-pandas"><a href="#2-pandas" class="headerlink" title="2.pandas"></a>2.pandas</h4><p>&emsp;&emsp;在pandas模块中，通过在<code>read_excel()</code>函数中设置<code>sheet_name=None</code>，可以一次性读取工作簿中的所有工作表。pandas将这些工作表读入一个数据框字典，字典中的键就是工作表的名称，值就是包含工作表中数据的数据框。通过在字典的键和值之间迭代，就可以使用工作簿中所有的数据。<br>&emsp;&emsp;使用pandas模块的代码如下：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"></span><br><span class="line">import pandas as pd</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">input_file = sys.argv[1]</span><br><span class="line">output_file = sys.argv[2]</span><br><span class="line"></span><br><span class="line">data_frame = pd.read_excel(input_file, sheet_name=None, index_col=None)</span><br><span class="line">row_output = []</span><br><span class="line">for worksheet_name, data in data_frame.items():</span><br><span class="line">    data[&apos;Sale Amount&apos;] = data[&apos;Sale Amount&apos;].str.replace(r&apos;\$&apos;, &apos;&apos;)</span><br><span class="line">    data[&apos;Sale Amount&apos;] = data[&apos;Sale Amount&apos;].str.replace(r&apos;,&apos;, &apos;&apos;)</span><br><span class="line">    data[&apos;Sale Amount&apos;] = data[&apos;Sale Amount&apos;].astype(float)</span><br><span class="line">    row_output.append(data[data[&apos;Sale Amount&apos;].astype(float) &gt; 2000.0])</span><br><span class="line">filtered_rows = pd.concat(row_output, axis=0, ignore_index=True)</span><br><span class="line">writer = pd.ExcelWriter(output_file)</span><br><span class="line">filtered_rows.to_excel(writer, sheet_name=&apos;sale_amount_gt2000&apos;, index=False)</span><br><span class="line">writer.save()</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;在命令行窗口中运行这个脚本，并打开输出文件查看结果。<br><img src="https://img-blog.csdnimg.cn/20200207214214557.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h2 id="在所有工作表中选取特定列"><a href="#在所有工作表中选取特定列" class="headerlink" title="在所有工作表中选取特定列"></a>在所有工作表中选取特定列</h2><h4 id="1-基础Python-1"><a href="#1-基础Python-1" class="headerlink" title="1.基础Python"></a>1.基础Python</h4><p>&emsp;&emsp;对于<a href="https://blog.csdn.net/qq_45554010/article/details/104102682" target="_blank" rel="noopener">《Python数据分析基础之Excel文件(1)》</a>中建立的sales_2013.xlsx这个Excel工作簿，我们想在所有工作表中选取Customer Name和Sale Amount列。代码如下：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"></span><br><span class="line">import sys</span><br><span class="line">from datetime import date</span><br><span class="line">from xlrd import open_workbook, xldate_as_tuple</span><br><span class="line">from xlwt import Workbook</span><br><span class="line"></span><br><span class="line">input_file = sys.argv[1]</span><br><span class="line">output_file = sys.argv[2]</span><br><span class="line"></span><br><span class="line">output_workbook = Workbook()</span><br><span class="line">output_worksheet = output_workbook.add_sheet(&apos;selected_columns_all_worksheets&apos;)</span><br><span class="line">my_columns = [&apos;Customer Name&apos;, &apos;Sale Amount&apos;]</span><br><span class="line">first_worksheet = True</span><br><span class="line">with open_workbook(input_file) as workbook:</span><br><span class="line">    data = [my_columns]</span><br><span class="line">    index_of_cols_to_keep = []</span><br><span class="line">    for worksheet in workbook.sheets():</span><br><span class="line">        if first_worksheet:</span><br><span class="line">            header = worksheet.row_values(0)</span><br><span class="line">            for column_index in range(len(header)):</span><br><span class="line">                if header[column_index] in my_columns:</span><br><span class="line">                    index_of_cols_to_keep.append(column_index)</span><br><span class="line">            first_worksheet = False</span><br><span class="line">        for row_index in range(1, worksheet.nrows):</span><br><span class="line">            row_list = []</span><br><span class="line">            for column_index in index_of_cols_to_keep:</span><br><span class="line">                cell_value = worksheet.cell_value(row_index, column_index)</span><br><span class="line">                cell_type = worksheet.cell_type(row_index, column_index)</span><br><span class="line">                if cell_type == 3:</span><br><span class="line">                    date_cell = xldate_as_tuple(cell_value, workbook.datemode)</span><br><span class="line">                    date_cell = date(*date_cell[0:3]).strftime(&apos;%m/%d/%Y&apos;)</span><br><span class="line">                    row_list.append(date_cell)</span><br><span class="line">                else:</span><br><span class="line">                    row_list.append(cell_value)</span><br><span class="line">            data.append(row_list)</span><br><span class="line">    for list_index, output_list in enumerate(data):</span><br><span class="line">        for element_index, element in enumerate(output_list):</span><br><span class="line">            output_worksheet.write(list_index, element_index, element)</span><br><span class="line">output_workbook.save(output_file)</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;列表变量<code>my_columns</code>包含了我们要保留的两列的名称。将<code>my_columns</code>放入<code>data</code>，作为<code>data</code>中的第一个列表，因为它是要写入输出文件的列的标题。列表变量<code>index_of_cols_to_keep</code>用来保存Customer Name和Sale Amount列的索引值。<br>&emsp;&emsp;在命令行窗口中运行这个脚本，并打开输出文件查看结果。<br><img src="https://img-blog.csdnimg.cn/2020020721552615.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h4 id="2-pandas-1"><a href="#2-pandas-1" class="headerlink" title="2.pandas"></a>2.pandas</h4><p>&emsp;&emsp;使用pandas模块的思路和上面筛选特定列的思路类似，代码如下：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"></span><br><span class="line">import pandas as pd</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">input_file = sys.argv[1]</span><br><span class="line">output_file = sys.argv[2]</span><br><span class="line"></span><br><span class="line">data_frame = pd.read_excel(input_file, sheet_name=None, index_col=None)</span><br><span class="line">column_output = []</span><br><span class="line">for worksheet_name, data in data_frame.items():</span><br><span class="line">    column_output.append(data.loc[:, [&apos;Customer Name&apos;, &apos;Sale Amount&apos;]])</span><br><span class="line">selected_columns = pd.concat(column_output, axis=0, ignore_index=True)</span><br><span class="line">writer = pd.ExcelWriter(output_file)</span><br><span class="line">selected_columns.to_excel(writer, sheet_name=&apos;selected_columns_all_worksheets&apos;, index=False)</span><br><span class="line">writer.save()</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;在命令行窗口中运行这个脚本，并打开输出文件查看结果。<br><img src="https://img-blog.csdnimg.cn/20200207220701568.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTU0MDEw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>

        </div>
    

</div>
            
        </section>
    </div>
</div>



    <div class="row">
        <div class="col-sm-12">
            <div class="wrap-pagination">
                <a class="" href="/">
                    <i class="fa fa-chevron-left" aria-hidden="true"></i>
                </a>
                <a class="" href="/page/3/">
                    <i class="fa fa-chevron-right" aria-hidden="true"></i>
                </a>
            </div>
        </div>
    </div>




</div>

<!-- Footer -->
<div class="push"></div>

<footer class="footer-content">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 footer-about">
                <h2>About</h2>
                <p>
                    I'd walk a million miles just to see your smile. 
                </p>
            </div>
            
    <div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 recent-posts">
        <h2>Recent Posts</h2>
        <ul>
            
            <li>
                <a class="footer-post" href="/2020/03/25/%E3%80%90Python%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB%E7%AC%94%E8%AE%B0%E3%80%91%E4%BF%A1%E6%81%AF%E6%A0%87%E8%AE%B0%E4%B8%8E%E6%8F%90%E5%8F%96%E6%96%B9%E6%B3%95/">【Python网络爬虫笔记】信息标记与提取方法</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2020/03/24/%E3%80%90Python%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB%E7%AC%94%E8%AE%B0%E3%80%91BeautifulSoup%E6%A8%A1%E5%9D%97%E5%9F%BA%E7%A1%80/">【Python网络爬虫笔记】BeautifulSo</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2020/03/23/%E3%80%90Python%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB%E7%AC%94%E8%AE%B0%E3%80%91requests%E6%A8%A1%E5%9D%97%E5%9F%BA%E7%A1%80/">&#39;【Python网络爬虫笔记】requests模块</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2020/03/16/%E5%AE%9E%E9%AA%8C%E5%AE%A420200314%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E4%BB%BB%E5%8A%A1%E6%80%BB%E7%BB%93/">实验室20200314数据处理任务总结</a>
            </li>
            
        </ul>
    </div>



            
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <ul class="list-inline footer-social-icons">
                    
                    <li class="list-inline-item">
                        <a href="https://github.com/CCH21" target="_blank" rel="noopener">
                            <span class="footer-icon-container">
                                <i class="fa fa-github"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    <li class="list-inline-item">
                        <a href="mailto:1398635912@qq.com" target="_blank" rel="noopener">
                            <span class="footer-icon-container">
                                <i class="fa fa-envelope-o"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div class="footer-copyright">
                    @Untitled. All right reserved | Design & Hexo <a href="http://www.codeblocq.com/" target="_blank" rel="noopener">Jonathan Klughertz</a>
                </div>
            </div>
        </div>
    </div>
</footer>

<!-- After footer scripts -->

<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Tween Max -->
<script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.5/TweenMax.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Custom JavaScript -->
<script src="/js/main.js"></script>

<!-- Disqus Comments -->



</body>

</html>